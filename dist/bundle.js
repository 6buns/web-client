var Bun=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=o(e);if(t){var i=o(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=f(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},l.apply(this,arguments)}function h(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var v=function(e,t){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},v(e,t)};function y(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))}function g(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function w(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}var k=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,S=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],E=function(e){var t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));for(var i,o,s=k.exec(e||""),a={},u=14;u--;)a[S[u]]=s[u]||"";return-1!=r&&-1!=n&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){var r=/\/{2,9}/g,n=t.replace(r,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||n.splice(0,1);"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1);return n}(0,a.path),a.queryKey=(i=a.query,o={},i.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(o[t]=r)})),o),a};var _={exports:{}};try{_.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){_.exports=!1}var C=_.exports,R="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function A(e){var t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||C))return new XMLHttpRequest}catch(e){}if(!t)try{return new(R[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function T(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((function(t,r){return e.hasOwnProperty(r)&&(t[r]=e[r]),t}),{})}var x=setTimeout,j=clearTimeout;function O(e,t){t.useNativeTimers?(e.setTimeoutFn=x.bind(R),e.clearTimeoutFn=j.bind(R)):(e.setTimeoutFn=setTimeout.bind(R),e.clearTimeoutFn=clearTimeout.bind(R))}var P=B;function B(e){if(e)return function(e){for(var t in B.prototype)e[t]=B.prototype[t];return e}(e)}B.prototype.on=B.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},B.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},B.prototype.off=B.prototype.removeListener=B.prototype.removeAllListeners=B.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},B.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t)}return this},B.prototype.emitReserved=B.prototype.emit,B.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},B.prototype.hasListeners=function(e){return!!this.listeners(e).length};var N=Object.create(null);N.open="0",N.close="1",N.ping="2",N.pong="3",N.message="4",N.upgrade="5",N.noop="6";var M=Object.create(null);Object.keys(N).forEach((function(e){M[N[e]]=e}));for(var L={type:"error",data:"parser error"},I="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),F="function"==typeof ArrayBuffer,D=function(e,t,r){var n,i=e.type,o=e.data;return I&&o instanceof Blob?t?r(o):U(o,r):F&&(o instanceof ArrayBuffer||(n=o,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer))?t?r(o):U(new Blob([o]),r):r(N[i]+(o||""))},U=function(e,t){var r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];t("b"+e)},r.readAsDataURL(e)},q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y="undefined"==typeof Uint8Array?[]:new Uint8Array(256),V=0;V<q.length;V++)Y[q.charCodeAt(V)]=V;var z,$="function"==typeof ArrayBuffer,H=function(e,t){if("string"!=typeof e)return{type:"message",data:K(e,t)};var r=e.charAt(0);return"b"===r?{type:"message",data:W(e.substring(1),t)}:M[r]?e.length>1?{type:M[r],data:e.substring(1)}:{type:M[r]}:L},W=function(e,t){if($){var r=function(e){var t,r,n,i,o,s=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),f=new Uint8Array(c);for(t=0;t<a;t+=4)r=Y[e.charCodeAt(t)],n=Y[e.charCodeAt(t+1)],i=Y[e.charCodeAt(t+2)],o=Y[e.charCodeAt(t+3)],f[u++]=r<<2|n>>4,f[u++]=(15&n)<<4|i>>2,f[u++]=(3&i)<<6|63&o;return c}(e);return K(r,t)}return{base64:!0,data:e}},K=function(e,t){return"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e},J=String.fromCharCode(30),G=function(e){i(s,e);var r=c(s);function s(e){var n;return t(this,s),(n=r.call(this)).writable=!1,O(a(n),e),n.opts=e,n.query=e.query,n.readyState="",n.socket=e.socket,n}return n(s,[{key:"onError",value:function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,l(o(s.prototype),"emit",this).call(this,"error",r),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,l(o(s.prototype),"emit",this).call(this,"open")}},{key:"onData",value:function(e){var t=H(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){l(o(s.prototype),"emit",this).call(this,"packet",e)}},{key:"onClose",value:function(){this.readyState="closed",l(o(s.prototype),"emit",this).call(this,"close")}}]),s}(P),X="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Z={},Q=0,ee=0;function te(e){var t="";do{t=X[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function re(){var e=te(+new Date);return e!==z?(Q=0,z=e):e+"."+te(Q++)}for(;ee<64;ee++)Z[X[ee]]=ee;re.encode=te,re.decode=function(e){var t=0;for(ee=0;ee<e.length;ee++)t=64*t+Z[e.charAt(ee)];return t};var ne=re,ie={encode:function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},decode:function(e){for(var t={},r=e.split("&"),n=0,i=r.length;n<i;n++){var o=r[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},oe=function(e){i(o,e);var r=c(o);function o(){var e;return t(this,o),(e=r.apply(this,arguments)).polling=!1,e}return n(o,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var r=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var n=0;this.polling&&(n++,this.once("pollComplete",(function(){--n||r()}))),this.writable||(n++,this.once("drain",(function(){--n||r()})))}else r()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emit("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var r=e.split(J),n=[],i=0;i<r.length;i++){var o=H(r[i],t);if(n.push(o),"error"===o.type)break}return n})(e,this.socket.binaryType).forEach((function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,t){var r=e.length,n=new Array(r),i=0;e.forEach((function(e,o){D(e,!1,(function(e){n[o]=e,++i===r&&t(n.join(J))}))}))}(e,(function(e){t.doWrite(e,(function(){t.writable=!0,t.emit("drain")}))}))}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"https":"http",r="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=ne()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port);var n=ie.encode(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}}]),o}(G);function se(){}var ae=null!=new A({xdomain:!1}).responseType,ue=function(e){i(o,e);var r=c(o);function o(e){var n;if(t(this,o),n=r.call(this,e),"undefined"!=typeof location){var i="https:"===location.protocol,s=location.port;s||(s=i?"443":"80"),n.xd="undefined"!=typeof location&&e.hostname!==location.hostname||s!==e.port,n.xs=e.secure!==i}var a=e&&e.forceBase64;return n.supportsBinary=ae&&!a,n}return n(o,[{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new ce(this.uri(),e)}},{key:"doWrite",value:function(e,t){var r=this,n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(function(e){r.onError("xhr post error",e)}))}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t}}]),o}(oe),ce=function(e){i(o,e);var r=c(o);function o(e,n){var i;return t(this,o),O(a(i=r.call(this)),n),i.opts=n,i.method=n.method||"GET",i.uri=e,i.async=!1!==n.async,i.data=void 0!==n.data?n.data:null,i.create(),i}return n(o,[{key:"create",value:function(){var e=this,t=T(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var r=this.xhr=new A(t);try{r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var n in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(n)&&r.setRequestHeader(n,this.opts.extraHeaders[n])}catch(e){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{r.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||1223===r.status?e.onLoad():e.setTimeoutFn((function(){e.onError("number"==typeof r.status?r.status:0)}),0))},r.send(this.data)}catch(t){return void this.setTimeoutFn((function(){e.onError(t)}),0)}"undefined"!=typeof document&&(this.index=o.requestsCount++,o.requests[this.index]=this)}},{key:"onSuccess",value:function(){this.emit("success"),this.cleanup()}},{key:"onData",value:function(e){this.emit("data",e),this.onSuccess()}},{key:"onError",value:function(e){this.emit("error",e),this.cleanup(!0)}},{key:"cleanup",value:function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=se,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete o.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&this.onData(e)}},{key:"abort",value:function(){this.cleanup()}}]),o}(P);if(ce.requestsCount=0,ce.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",fe);else if("function"==typeof addEventListener){addEventListener("onpagehide"in R?"pagehide":"unload",fe,!1)}function fe(){for(var e in ce.requests)ce.requests.hasOwnProperty(e)&&ce.requests[e].abort()}var le="function"==typeof Promise&&"function"==typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},he=R.WebSocket||R.MozWebSocket,pe="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),de=function(e){i(o,e);var r=c(o);function o(e){var n;return t(this,o),(n=r.call(this,e)).supportsBinary=!e.forceBase64,n}return n(o,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,r=pe?{}:T(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=pe?new he(e,t,r):t?new he(e,t):new he(e)}catch(e){return this.emit("error",e)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var r=function(r){var n=e[r],i=r===e.length-1;D(n,t.supportsBinary,(function(e){try{t.ws.send(e)}catch(e){}i&&le((function(){t.writable=!0,t.emit("drain")}),t.setTimeoutFn)}))},n=0;n<e.length;n++)r(n)}},{key:"doClose",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"wss":"ws",r="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=ne()),this.supportsBinary||(e.b64=1);var n=ie.encode(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}},{key:"check",value:function(){return!(!he||"__initialize"in he&&this.name===o.prototype.name)}}]),o}(G),ve={websocket:de,polling:ue},ye=function(r){i(s,r);var o=c(s);function s(r){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,s),n=o.call(this),r&&"object"===e(r)&&(i=r,r=null),r?(r=E(r),i.hostname=r.host,i.secure="https"===r.protocol||"wss"===r.protocol,i.port=r.port,r.query&&(i.query=r.query)):i.host&&(i.hostname=E(i.host).host),O(a(n),i),n.secure=null!=i.secure?i.secure:"undefined"!=typeof location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=n.secure?"443":"80"),n.hostname=i.hostname||("undefined"!=typeof location?location.hostname:"localhost"),n.port=i.port||("undefined"!=typeof location&&location.port?location.port:n.secure?"443":"80"),n.transports=i.transports||["polling","websocket"],n.readyState="",n.writeBuffer=[],n.prevBufferLen=0,n.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},i),n.opts.path=n.opts.path.replace(/\/$/,"")+"/","string"==typeof n.opts.query&&(n.opts.query=ie.decode(n.opts.query)),n.id=null,n.upgrades=null,n.pingInterval=null,n.pingTimeout=null,n.pingTimeoutTimer=null,"function"==typeof addEventListener&&(n.opts.closeOnBeforeunload&&addEventListener("beforeunload",(function(){n.transport&&(n.transport.removeAllListeners(),n.transport.close())}),!1),"localhost"!==n.hostname&&(n.offlineEventListener=function(){n.onClose("transport close")},addEventListener("offline",n.offlineEventListener,!1))),n.open(),n}return n(s,[{key:"createTransport",value:function(e){var t=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new ve[e](r)}},{key:"open",value:function(){var e,t=this;if(this.opts.rememberUpgrade&&s.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((function(){t.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(function(){t.onClose("transport close")}))}},{key:"probe",value:function(e){var t=this,r=this.createTransport(e),n=!1;s.priorWebsocketSuccess=!1;var i=function(){n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",(function(e){if(!n)if("pong"===e.type&&"probe"===e.data){if(t.upgrading=!0,t.emitReserved("upgrading",r),!r)return;s.priorWebsocketSuccess="websocket"===r.name,t.transport.pause((function(){n||"closed"!==t.readyState&&(l(),t.setTransport(r),r.send([{type:"upgrade"}]),t.emitReserved("upgrade",r),r=null,t.upgrading=!1,t.flush())}))}else{var i=new Error("probe error");i.transport=r.name,t.emitReserved("upgradeError",i)}})))};function o(){n||(n=!0,l(),r.close(),r=null)}var a=function(e){var n=new Error("probe error: "+e);n.transport=r.name,o(),t.emitReserved("upgradeError",n)};function u(){a("transport closed")}function c(){a("socket closed")}function f(e){r&&e.name!==r.name&&o()}var l=function(){r.removeListener("open",i),r.removeListener("error",a),r.removeListener("close",u),t.off("close",c),t.off("upgrading",f)};r.once("open",i),r.once("error",a),r.once("close",u),this.once("close",c),this.once("upgrading",f),r.open()}},{key:"onOpen",value:function(){if(this.readyState="open",s.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((function(){e.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}},{key:"write",value:function(e,t,r){return this.sendPacket("message",e,t,r),this}},{key:"send",value:function(e,t,r){return this.sendPacket("message",e,t,r),this}},{key:"sendPacket",value:function(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}}},{key:"close",value:function(){var e=this,t=function(){e.onClose("forced close"),e.transport.close()},r=function r(){e.off("upgrade",r),e.off("upgradeError",r),t()},n=function(){e.once("upgrade",r),e.once("upgradeError",r)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){e.upgrading?n():t()})):this.upgrading?n():t()),this}},{key:"onError",value:function(e){s.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],r=0,n=e.length;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}]),s}(P);ye.protocol=4;var ge="function"==typeof ArrayBuffer,me=Object.prototype.toString,be="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===me.call(Blob),we="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===me.call(File);function ke(e){return ge&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))||be&&e instanceof Blob||we&&e instanceof File}function Se(t,r){if(!t||"object"!==e(t))return!1;if(Array.isArray(t)){for(var n=0,i=t.length;n<i;n++)if(Se(t[n]))return!0;return!1}if(ke(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return Se(t.toJSON(),!0);for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&Se(t[o]))return!0;return!1}function Ee(e){var t=[],r=e.data,n=e;return n.data=_e(r,t),n.attachments=t.length,{packet:n,buffers:t}}function _e(t,r){if(!t)return t;if(ke(t)){var n={_placeholder:!0,num:r.length};return r.push(t),n}if(Array.isArray(t)){for(var i=new Array(t.length),o=0;o<t.length;o++)i[o]=_e(t[o],r);return i}if("object"===e(t)&&!(t instanceof Date)){var s={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(s[a]=_e(t[a],r));return s}return t}function Ce(e,t){return e.data=Re(e.data,t),e.attachments=void 0,e}function Re(t,r){if(!t)return t;if(t&&t._placeholder)return r[t.num];if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]=Re(t[n],r);else if("object"===e(t))for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=Re(t[i],r));return t}var Ae;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Ae||(Ae={}));var Te=function(){function e(){t(this,e)}return n(e,[{key:"encode",value:function(e){return e.type!==Ae.EVENT&&e.type!==Ae.ACK||!Se(e)?[this.encodeAsString(e)]:(e.type=e.type===Ae.EVENT?Ae.BINARY_EVENT:Ae.BINARY_ACK,this.encodeAsBinary(e))}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==Ae.BINARY_EVENT&&e.type!==Ae.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data)),t}},{key:"encodeAsBinary",value:function(e){var t=Ee(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}]),e}(),xe=function(r){i(a,r);var s=c(a);function a(){return t(this,a),s.call(this)}return n(a,[{key:"add",value:function(e){var t;if("string"==typeof e)(t=this.decodeString(e)).type===Ae.BINARY_EVENT||t.type===Ae.BINARY_ACK?(this.reconstructor=new je(t),0===t.attachments&&l(o(a.prototype),"emitReserved",this).call(this,"decoded",t)):l(o(a.prototype),"emitReserved",this).call(this,"decoded",t);else{if(!ke(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,l(o(a.prototype),"emitReserved",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,r={type:Number(e.charAt(0))};if(void 0===Ae[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Ae.BINARY_EVENT||r.type===Ae.BINARY_ACK){for(var n=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var i=e.substring(n,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){for(var o=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(o,t)}else r.nsp="/";var s=e.charAt(t+1);if(""!==s&&Number(s)==s){for(var u=t+1;++t;){var c=e.charAt(t);if(null==c||Number(c)!=c){--t;break}if(t===e.length)break}r.id=Number(e.substring(u,t+1))}if(e.charAt(++t)){var f=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!a.isPayloadValid(r.type,f))throw new Error("invalid payload");r.data=f}return r}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(t,r){switch(t){case Ae.CONNECT:return"object"===e(r);case Ae.DISCONNECT:return void 0===r;case Ae.CONNECT_ERROR:return"string"==typeof r||"object"===e(r);case Ae.EVENT:case Ae.BINARY_EVENT:return Array.isArray(r)&&r.length>0;case Ae.ACK:case Ae.BINARY_ACK:return Array.isArray(r)}}}]),a}(P);var je=function(){function e(r){t(this,e),this.packet=r,this.buffers=[],this.reconPack=r}return n(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=Ce(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}(),Oe=Object.freeze({__proto__:null,protocol:5,get PacketType(){return Ae},Encoder:Te,Decoder:xe});function Pe(e,t,r){return e.on(t,r),function(){e.off(t,r)}}var Be=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Ne=function(e){i(s,e);var r=c(s);function s(e,n,i){var o;return t(this,s),(o=r.call(this)).connected=!1,o.disconnected=!0,o.receiveBuffer=[],o.sendBuffer=[],o.ids=0,o.acks={},o.flags={},o.io=e,o.nsp=n,i&&i.auth&&(o.auth=i.auth),o.io._autoConnect&&o.open(),o}return n(s,[{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[Pe(e,"open",this.onopen.bind(this)),Pe(e,"packet",this.onpacket.bind(this)),Pe(e,"error",this.onerror.bind(this)),Pe(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(Be.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.unshift(e);var i={type:Ae.EVENT,data:r,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof r[r.length-1]){var o=this.ids++,s=r.pop();this._registerAckCallback(o,s),i.id=o}var a=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,u=this.flags.volatile&&(!a||!this.connected);return u||(this.connected?this.packet(i):this.sendBuffer.push(i)),this.flags={},this}},{key:"_registerAckCallback",value:function(e,t){var r=this,n=this.flags.timeout;if(void 0!==n){var i=this.io.setTimeoutFn((function(){delete r.acks[e];for(var n=0;n<r.sendBuffer.length;n++)r.sendBuffer[n].id===e&&r.sendBuffer.splice(n,1);t.call(r,new Error("operation has timed out"))}),n);this.acks[e]=function(){r.io.clearTimeoutFn(i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];t.apply(r,[null].concat(n))}}else this.acks[e]=t}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;"function"==typeof this.auth?this.auth((function(t){e.packet({type:Ae.CONNECT,data:t})})):this.packet({type:Ae.CONNECT,data:this.auth})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case Ae.CONNECT:if(e.data&&e.data.sid){var t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ae.EVENT:case Ae.BINARY_EVENT:this.onevent(e);break;case Ae.ACK:case Ae.BINARY_ACK:this.onack(e);break;case Ae.DISCONNECT:this.ondisconnect();break;case Ae.CONNECT_ERROR:this.destroy();var r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=p(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}(this._anyListeners.slice());try{for(r.s();!(t=r.n()).done;){t.value.apply(this,e)}}catch(e){r.e(e)}finally{r.f()}}l(o(s.prototype),"emit",this).apply(this,e)}},{key:"ack",value:function(e){var t=this,r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];t.packet({type:Ae.ACK,id:e,data:i})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e){this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach((function(t){return e.emitEvent(t)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(t){return e.packet(t)})),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach((function(e){return e()})),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:Ae.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}}]),s}(P),Me=Le;function Le(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Le.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},Le.prototype.reset=function(){this.attempts=0},Le.prototype.setMin=function(e){this.ms=e},Le.prototype.setMax=function(e){this.max=e},Le.prototype.setJitter=function(e){this.jitter=e};var Ie=function(r){i(s,r);var o=c(s);function s(r,n){var i,u;t(this,s),(i=o.call(this)).nsps={},i.subs=[],r&&"object"===e(r)&&(n=r,r=void 0),(n=n||{}).path=n.path||"/socket.io",i.opts=n,O(a(i),n),i.reconnection(!1!==n.reconnection),i.reconnectionAttempts(n.reconnectionAttempts||1/0),i.reconnectionDelay(n.reconnectionDelay||1e3),i.reconnectionDelayMax(n.reconnectionDelayMax||5e3),i.randomizationFactor(null!==(u=n.randomizationFactor)&&void 0!==u?u:.5),i.backoff=new Me({min:i.reconnectionDelay(),max:i.reconnectionDelayMax(),jitter:i.randomizationFactor()}),i.timeout(null==n.timeout?2e4:n.timeout),i._readyState="closed",i.uri=r;var c=n.parser||Oe;return i.encoder=new c.Encoder,i.decoder=new c.Decoder,i._autoConnect=!1!==n.autoConnect,i._autoConnect&&i.open(),i}return n(s,[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(~this._readyState.indexOf("open"))return this;this.engine=new ye(this.uri,this.opts);var r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;var i=Pe(r,"open",(function(){n.onopen(),e&&e()})),o=Pe(r,"error",(function(r){n.cleanup(),n._readyState="closed",t.emitReserved("error",r),e?e(r):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){var s=this._timeout;0===s&&i();var a=this.setTimeoutFn((function(){i(),r.close(),r.emit("error",new Error("timeout"))}),s);this.opts.autoUnref&&a.unref(),this.subs.push((function(){clearTimeout(a)}))}return this.subs.push(i),this.subs.push(o),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(Pe(e,"ping",this.onping.bind(this)),Pe(e,"data",this.ondata.bind(this)),Pe(e,"error",this.onerror.bind(this)),Pe(e,"close",this.onclose.bind(this)),Pe(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){this.decoder.add(e)}},{key:"ondecoded",value:function(e){this.emitReserved("packet",e)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var r=this.nsps[e];return r||(r=new Ne(this,e,t),this.nsps[e]=r),r}},{key:"_destroy",value:function(e){for(var t=0,r=Object.keys(this.nsps);t<r.length;t++){var n=r[t];if(this.nsps[n].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),r=0;r<t.length;r++)this.engine.write(t[r],e.options)}},{key:"cleanup",value:function(){this.subs.forEach((function(e){return e()})),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var r=this.backoff.duration();this._reconnecting=!0;var n=this.setTimeoutFn((function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((function(r){r?(t._reconnecting=!1,t.reconnect(),e.emitReserved("reconnect_error",r)):t.onreconnect()})))}),r);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}]),s}(P),Fe={};function De(t,r){"object"===e(t)&&(r=t,t=void 0);var n,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=e;r=r||"undefined"!=typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),n=E(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}(t,(r=r||{}).path||"/socket.io"),o=i.source,s=i.id,a=i.path,u=Fe[s]&&a in Fe[s].nsps;return r.forceNew||r["force new connection"]||!1===r.multiplex||u?n=new Ie(o,r):(Fe[s]||(Fe[s]=new Ie(o,r)),n=Fe[s]),i.query&&!r.query&&(r.query=i.queryKey),n.socket(i.path,r)}Object.assign(De,{Manager:Ie,Socket:Ne,io:De,connect:De});var Ue={exports:{}},qe=1e3,Ye=6e4,Ve=60*Ye,ze=24*Ve,$e=7*ze,He=365.25*ze,We=function(t,r){r=r||{};var n=e(t);if("string"===n&&t.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*He;case"weeks":case"week":case"w":return r*$e;case"days":case"day":case"d":return r*ze;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ve;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ye;case"seconds":case"second":case"secs":case"sec":case"s":return r*qe;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(t);if("number"===n&&isFinite(t))return r.long?function(e){var t=Math.abs(e);if(t>=ze)return Ke(e,t,ze,"day");if(t>=Ve)return Ke(e,t,Ve,"hour");if(t>=Ye)return Ke(e,t,Ye,"minute");if(t>=qe)return Ke(e,t,qe,"second");return e+" ms"}(t):function(e){var t=Math.abs(e);if(t>=ze)return Math.round(e/ze)+"d";if(t>=Ve)return Math.round(e/Ve)+"h";if(t>=Ye)return Math.round(e/Ye)+"m";if(t>=qe)return Math.round(e/qe)+"s";return e+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Ke(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}var Je,Ge,Xe,Ze=function(e){function t(e){var n,i,o,s=null;function a(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];if(a.enabled){var o=a,s=Number(new Date),u=s-(n||s);o.diff=u,o.prev=n,o.curr=s,n=s,r[0]=t.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");var c=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return"%";c++;var i=t.formatters[n];if("function"==typeof i){var s=r[c];e=i.call(o,s),r.splice(c,1),c--}return e})),t.formatArgs.call(o,r);var f=o.log||t.log;f.apply(o,r)}}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o)},set:function(e){s=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,r){var n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(h(t.names.map(n)),h(t.skips.map(n).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=We,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t};Je=Ue,(Ge=Ue.exports).formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Je.exports.humanize(this.diff),this.useColors){var t="color: "+this.color;e.splice(1,0,t,"color: inherit");var r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(n=r))})),e.splice(n,0,t)}},Ge.save=function(e){try{e?Ge.storage.setItem("debug",e):Ge.storage.removeItem("debug")}catch(e){}},Ge.load=function(){var e;try{e=Ge.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},Ge.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},Ge.storage=function(){try{return localStorage}catch(e){}}(),Ge.destroy=(Xe=!1,function(){Xe||(Xe=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),Ge.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],Ge.log=console.debug||console.log||function(){},Je.exports=Ze(Ge),Je.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}};var Qe,et=Ue.exports,tt={exports:{}},rt="object"===("undefined"==typeof Reflect?"undefined":e(Reflect))?Reflect:null,nt=rt&&"function"==typeof rt.apply?rt.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};Qe=rt&&"function"==typeof rt.ownKeys?rt.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var it=Number.isNaN||function(e){return e!=e};function ot(){ot.init.call(this)}tt.exports=ot,tt.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}vt(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&vt(e,"error",t,r)}(e,i,{once:!0})}))},ot.EventEmitter=ot,ot.prototype._events=void 0,ot.prototype._eventsCount=0,ot.prototype._maxListeners=void 0;var st=10;function at(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+e(t))}function ut(e){return void 0===e._maxListeners?ot.defaultMaxListeners:e._maxListeners}function ct(e,t,r,n){var i,o,s,a;if(at(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=ut(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return e}function ft(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function lt(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=ft.bind(n);return i.listener=r,n.wrapFn=i,i}function ht(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):dt(i,i.length)}function pt(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function dt(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function vt(t,r,n,i){if("function"==typeof t.on)i.once?t.once(r,n):t.on(r,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+e(t));t.addEventListener(r,(function e(o){i.once&&t.removeEventListener(r,e),n(o)}))}}Object.defineProperty(ot,"defaultMaxListeners",{enumerable:!0,get:function(){return st},set:function(e){if("number"!=typeof e||e<0||it(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");st=e}}),ot.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ot.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||it(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},ot.prototype.getMaxListeners=function(){return ut(this)},ot.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)nt(a,this,t);else{var u=a.length,c=dt(a,u);for(r=0;r<u;++r)nt(c[r],this,t)}return!0},ot.prototype.addListener=function(e,t){return ct(this,e,t,!1)},ot.prototype.on=ot.prototype.addListener,ot.prototype.prependListener=function(e,t){return ct(this,e,t,!0)},ot.prototype.once=function(e,t){return at(t),this.on(e,lt(this,e,t)),this},ot.prototype.prependOnceListener=function(e,t){return at(t),this.prependListener(e,lt(this,e,t)),this},ot.prototype.removeListener=function(e,t){var r,n,i,o,s;if(at(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},ot.prototype.off=ot.prototype.removeListener,ot.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},ot.prototype.listeners=function(e){return ht(this,e,!0)},ot.prototype.rawListeners=function(e){return ht(this,e,!1)},ot.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):pt.call(e,t)},ot.prototype.listenerCount=pt,ot.prototype.eventNames=function(){return this._eventsCount>0?Qe(this._events):[]};var yt=tt.exports,gt={},mt={exports:{}},bt=[],wt=[],kt="undefined"!=typeof Uint8Array?Uint8Array:Array,St=!1;function Et(){St=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)bt[t]=e[t],wt[e.charCodeAt(t)]=t;wt["-".charCodeAt(0)]=62,wt["_".charCodeAt(0)]=63}function _t(e,t,r){for(var n,i,o=[],s=t;s<r;s+=3)n=(e[s]<<16)+(e[s+1]<<8)+e[s+2],o.push(bt[(i=n)>>18&63]+bt[i>>12&63]+bt[i>>6&63]+bt[63&i]);return o.join("")}function Ct(e){var t;St||Et();for(var r=e.length,n=r%3,i="",o=[],s=16383,a=0,u=r-n;a<u;a+=s)o.push(_t(e,a,a+s>u?u:a+s));return 1===n?(t=e[r-1],i+=bt[t>>2],i+=bt[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=bt[t>>10],i+=bt[t>>4&63],i+=bt[t<<2&63],i+="="),o.push(i),o.join("")}function Rt(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,f=-7,l=r?i-1:0,h=r?-1:1,p=e[t+l];for(l+=h,o=p&(1<<-f)-1,p>>=-f,f+=a;f>0;o=256*o+e[t+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;f>0;s=256*s+e[t+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=c}return(p?-1:1)*s*Math.pow(2,o-n)}function At(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+l>=1?h/u:h*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(t*u-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+p]=255&s,p+=d,s/=256,c-=8);e[r+p-d]|=128*v}var Tt={}.toString,xt=Array.isArray||function(e){return"[object Array]"==Tt.call(e)};Bt.TYPED_ARRAY_SUPPORT=void 0===global.TYPED_ARRAY_SUPPORT||global.TYPED_ARRAY_SUPPORT;var jt=Ot();function Ot(){return Bt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Pt(e,t){if(Ot()<t)throw new RangeError("Invalid typed array length");return Bt.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Bt.prototype:(null===e&&(e=new Bt(t)),e.length=t),e}function Bt(e,t,r){if(!(Bt.TYPED_ARRAY_SUPPORT||this instanceof Bt))return new Bt(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return Lt(this,e)}return Nt(this,e,t,r)}function Nt(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);Bt.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Bt.prototype:e=It(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!Bt.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|Ut(t,r),i=(e=Pt(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(Dt(t)){var r=0|Ft(t.length);return 0===(e=Pt(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?Pt(e,0):It(e,t);if("Buffer"===t.type&&xt(t.data))return It(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function Mt(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function Lt(e,t){if(Mt(t),e=Pt(e,t<0?0:0|Ft(t)),!Bt.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function It(e,t){var r=t.length<0?0:0|Ft(t.length);e=Pt(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function Ft(e){if(e>=Ot())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ot().toString(16)+" bytes");return 0|e}function Dt(e){return!(null==e||!e._isBuffer)}function Ut(e,t){if(Dt(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return pr(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return dr(e).length;default:if(n)return pr(e).length;t=(""+t).toLowerCase(),n=!0}}function qt(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return rr(this,t,r);case"utf8":case"utf-8":return Zt(this,t,r);case"ascii":return er(this,t,r);case"latin1":case"binary":return tr(this,t,r);case"base64":return Xt(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return nr(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function Yt(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Vt(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=Bt.from(t,n)),Dt(t))return 0===t.length?-1:zt(e,t,r,n,i);if("number"==typeof t)return t&=255,Bt.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):zt(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function zt(e,t,r,n,i){var o,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var f=-1;for(o=r;o<a;o++)if(c(e,o)===c(t,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===u)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var l=!0,h=0;h<u;h++)if(c(e,o+h)!==c(t,h)){l=!1;break}if(l)return o}return-1}function $t(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function Ht(e,t,r,n){return vr(pr(t,e.length-r),e,r,n)}function Wt(e,t,r,n){return vr(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function Kt(e,t,r,n){return Wt(e,t,r,n)}function Jt(e,t,r,n){return vr(dr(t),e,r,n)}function Gt(e,t,r,n){return vr(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function Xt(e,t,r){return 0===t&&r===e.length?Ct(e):Ct(e.slice(t,r))}function Zt(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,u,c=e[i],f=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=r)switch(l){case 1:c<128&&(f=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(f=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(f=u)}null===f?(f=65533,l=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),i+=l}return function(e){var t=e.length;if(t<=Qt)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Qt));return r}(n)}Bt.poolSize=8192,Bt._augment=function(e){return e.__proto__=Bt.prototype,e},Bt.from=function(e,t,r){return Nt(null,e,t,r)},Bt.TYPED_ARRAY_SUPPORT&&(Bt.prototype.__proto__=Uint8Array.prototype,Bt.__proto__=Uint8Array),Bt.alloc=function(e,t,r){return function(e,t,r,n){return Mt(t),t<=0?Pt(e,t):void 0!==r?"string"==typeof n?Pt(e,t).fill(r,n):Pt(e,t).fill(r):Pt(e,t)}(null,e,t,r)},Bt.allocUnsafe=function(e){return Lt(null,e)},Bt.allocUnsafeSlow=function(e){return Lt(null,e)},Bt.isBuffer=yr,Bt.compare=function(e,t){if(!Dt(e)||!Dt(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},Bt.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Bt.concat=function(e,t){if(!xt(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Bt.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Bt.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!Dt(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},Bt.byteLength=Ut,Bt.prototype._isBuffer=!0,Bt.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Yt(this,t,t+1);return this},Bt.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Yt(this,t,t+3),Yt(this,t+1,t+2);return this},Bt.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Yt(this,t,t+7),Yt(this,t+1,t+6),Yt(this,t+2,t+5),Yt(this,t+3,t+4);return this},Bt.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?Zt(this,0,e):qt.apply(this,arguments)},Bt.prototype.equals=function(e){if(!Dt(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Bt.compare(this,e)},Bt.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},Bt.prototype.compare=function(e,t,r,n,i){if(!Dt(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(n,i),c=e.slice(t,r),f=0;f<a;++f)if(u[f]!==c[f]){o=u[f],s=c[f];break}return o<s?-1:s<o?1:0},Bt.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Bt.prototype.indexOf=function(e,t,r){return Vt(this,e,t,r,!0)},Bt.prototype.lastIndexOf=function(e,t,r){return Vt(this,e,t,r,!1)},Bt.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return $t(this,e,t,r);case"utf8":case"utf-8":return Ht(this,e,t,r);case"ascii":return Wt(this,e,t,r);case"latin1":case"binary":return Kt(this,e,t,r);case"base64":return Jt(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Gt(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},Bt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Qt=4096;function er(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function tr(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function rr(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=hr(e[o]);return i}function nr(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function ir(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function or(e,t,r,n,i,o){if(!Dt(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function sr(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function ar(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function ur(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function cr(e,t,r,n,i){return i||ur(e,0,r,4),At(e,t,r,n,23,4),r+4}function fr(e,t,r,n,i){return i||ur(e,0,r,8),At(e,t,r,n,52,8),r+8}Bt.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),Bt.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=Bt.prototype;else{var i=t-e;r=new Bt(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},Bt.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||ir(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},Bt.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||ir(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},Bt.prototype.readUInt8=function(e,t){return t||ir(e,1,this.length),this[e]},Bt.prototype.readUInt16LE=function(e,t){return t||ir(e,2,this.length),this[e]|this[e+1]<<8},Bt.prototype.readUInt16BE=function(e,t){return t||ir(e,2,this.length),this[e]<<8|this[e+1]},Bt.prototype.readUInt32LE=function(e,t){return t||ir(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Bt.prototype.readUInt32BE=function(e,t){return t||ir(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Bt.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||ir(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},Bt.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||ir(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},Bt.prototype.readInt8=function(e,t){return t||ir(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Bt.prototype.readInt16LE=function(e,t){t||ir(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Bt.prototype.readInt16BE=function(e,t){t||ir(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Bt.prototype.readInt32LE=function(e,t){return t||ir(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Bt.prototype.readInt32BE=function(e,t){return t||ir(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Bt.prototype.readFloatLE=function(e,t){return t||ir(e,4,this.length),Rt(this,e,!0,23,4)},Bt.prototype.readFloatBE=function(e,t){return t||ir(e,4,this.length),Rt(this,e,!1,23,4)},Bt.prototype.readDoubleLE=function(e,t){return t||ir(e,8,this.length),Rt(this,e,!0,52,8)},Bt.prototype.readDoubleBE=function(e,t){return t||ir(e,8,this.length),Rt(this,e,!1,52,8)},Bt.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||or(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},Bt.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||or(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},Bt.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,1,255,0),Bt.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Bt.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,2,65535,0),Bt.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):sr(this,e,t,!0),t+2},Bt.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,2,65535,0),Bt.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):sr(this,e,t,!1),t+2},Bt.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,4,4294967295,0),Bt.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):ar(this,e,t,!0),t+4},Bt.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,4,4294967295,0),Bt.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ar(this,e,t,!1),t+4},Bt.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);or(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},Bt.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);or(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},Bt.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,1,127,-128),Bt.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Bt.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,2,32767,-32768),Bt.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):sr(this,e,t,!0),t+2},Bt.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,2,32767,-32768),Bt.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):sr(this,e,t,!1),t+2},Bt.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,4,2147483647,-2147483648),Bt.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):ar(this,e,t,!0),t+4},Bt.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||or(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Bt.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ar(this,e,t,!1),t+4},Bt.prototype.writeFloatLE=function(e,t,r){return cr(this,e,t,!0,r)},Bt.prototype.writeFloatBE=function(e,t,r){return cr(this,e,t,!1,r)},Bt.prototype.writeDoubleLE=function(e,t,r){return fr(this,e,t,!0,r)},Bt.prototype.writeDoubleBE=function(e,t,r){return fr(this,e,t,!1,r)},Bt.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!Bt.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},Bt.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Bt.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=Dt(e)?e:pr(new Bt(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var lr=/[^+\/0-9A-Za-z-_]/g;function hr(e){return e<16?"0"+e.toString(16):e.toString(16)}function pr(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function dr(e){return function(e){var t,r,n,i,o,s;St||Et();var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[a-2]?2:"="===e[a-1]?1:0,s=new kt(3*a/4-o),n=o>0?a-4:a;var u=0;for(t=0,r=0;t<n;t+=4,r+=3)i=wt[e.charCodeAt(t)]<<18|wt[e.charCodeAt(t+1)]<<12|wt[e.charCodeAt(t+2)]<<6|wt[e.charCodeAt(t+3)],s[u++]=i>>16&255,s[u++]=i>>8&255,s[u++]=255&i;return 2===o?(i=wt[e.charCodeAt(t)]<<2|wt[e.charCodeAt(t+1)]>>4,s[u++]=255&i):1===o&&(i=wt[e.charCodeAt(t)]<<10|wt[e.charCodeAt(t+1)]<<4|wt[e.charCodeAt(t+2)]>>2,s[u++]=i>>8&255,s[u++]=255&i),s}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(lr,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function vr(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function yr(e){return null!=e&&(!!e._isBuffer||gr(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&gr(e.slice(0,0))}(e))}function gr(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var mr=Object.freeze({__proto__:null,INSPECT_MAX_BYTES:50,kMaxLength:jt,Buffer:Bt,SlowBuffer:function(e){return+e!=e&&(e=0),Bt.alloc(+e)},isBuffer:yr}),br=w(mr);function wr(){throw new Error("setTimeout has not been defined")}function kr(){throw new Error("clearTimeout has not been defined")}!function(e,t){var r=br,n=r.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o),i(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(mt,mt.exports);var Sr=wr,Er=kr;function _r(e){if(Sr===setTimeout)return setTimeout(e,0);if((Sr===wr||!Sr)&&setTimeout)return Sr=setTimeout,setTimeout(e,0);try{return Sr(e,0)}catch(t){try{return Sr.call(null,e,0)}catch(t){return Sr.call(this,e,0)}}}"function"==typeof global.setTimeout&&(Sr=setTimeout),"function"==typeof global.clearTimeout&&(Er=clearTimeout);var Cr,Rr=[],Ar=!1,Tr=-1;function xr(){Ar&&Cr&&(Ar=!1,Cr.length?Rr=Cr.concat(Rr):Tr=-1,Rr.length&&jr())}function jr(){if(!Ar){var e=_r(xr);Ar=!0;for(var t=Rr.length;t;){for(Cr=Rr,Rr=[];++Tr<t;)Cr&&Cr[Tr].run();Tr=-1,t=Rr.length}Cr=null,Ar=!1,function(e){if(Er===clearTimeout)return clearTimeout(e);if((Er===kr||!Er)&&clearTimeout)return Er=clearTimeout,clearTimeout(e);try{Er(e)}catch(t){try{return Er.call(null,e)}catch(t){return Er.call(this,e)}}}(e)}}function Or(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];Rr.push(new Pr(e,t)),1!==Rr.length||Ar||_r(jr)}function Pr(e,t){this.fun=e,this.array=t}Pr.prototype.run=function(){this.fun.apply(null,this.array)};var Br=global.performance||{};Br.now||Br.mozNow||Br.msNow||Br.oNow||Br.webkitNow;var Nr="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e},Mr=/%[sdj%]/g;function Lr(e){if(!Zr(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(qr(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,o=String(e).replace(Mr,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),s=n[r];r<i;s=n[++r])Jr(s)||!rn(s)?o+=" "+s:o+=" "+qr(s);return o}function Ir(e,t){if(en(global.process))return function(){return Ir(e,t).apply(this,arguments)};var r=!1;return function(){return r||(console.error(t),r=!0),e.apply(this,arguments)}}var Fr,Dr={};function Ur(e){if(en(Fr)&&(Fr=""),e=e.toUpperCase(),!Dr[e])if(new RegExp("\\b"+e+"\\b","i").test(Fr)){Dr[e]=function(){var t=Lr.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else Dr[e]=function(){};return Dr[e]}function qr(e,t){var r={seen:[],stylize:Vr};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),Kr(t)?r.showHidden=t:t&&dn(r,t),en(r.showHidden)&&(r.showHidden=!1),en(r.depth)&&(r.depth=2),en(r.colors)&&(r.colors=!1),en(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=Yr),zr(r,e,r.depth)}function Yr(e,t){var r=qr.styles[t];return r?"["+qr.colors[r][0]+"m"+e+"["+qr.colors[r][1]+"m":e}function Vr(e,t){return e}function zr(e,t,r){if(e.customInspect&&t&&sn(t.inspect)&&t.inspect!==qr&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return Zr(n)||(n=zr(e,n,r)),n}var i=function(e,t){if(en(t))return e.stylize("undefined","undefined");if(Zr(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(Xr(t))return e.stylize(""+t,"number");if(Kr(t))return e.stylize(""+t,"boolean");if(Jr(t))return e.stylize("null","null")}(e,t);if(i)return i;var o=Object.keys(t),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),on(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return $r(t);if(0===o.length){if(sn(t)){var a=t.name?": "+t.name:"";return e.stylize("[Function"+a+"]","special")}if(tn(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(nn(t))return e.stylize(Date.prototype.toString.call(t),"date");if(on(t))return $r(t)}var u,c="",f=!1,l=["{","}"];(Wr(t)&&(f=!0,l=["[","]"]),sn(t))&&(c=" [Function"+(t.name?": "+t.name:"")+"]");return tn(t)&&(c=" "+RegExp.prototype.toString.call(t)),nn(t)&&(c=" "+Date.prototype.toUTCString.call(t)),on(t)&&(c=" "+$r(t)),0!==o.length||f&&0!=t.length?r<0?tn(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=f?function(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)vn(t,String(s))?o.push(Hr(e,t,r,n,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(Hr(e,t,r,n,i,!0))})),o}(e,t,r,s,o):o.map((function(n){return Hr(e,t,r,s,n,f)})),e.seen.pop(),function(e,t,r){var n=e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,c,l)):l[0]+c+l[1]}function $r(e){return"["+Error.prototype.toString.call(e)+"]"}function Hr(e,t,r,n,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),vn(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=Jr(r)?zr(e,u.value,null):zr(e,u.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),en(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function Wr(e){return Array.isArray(e)}function Kr(e){return"boolean"==typeof e}function Jr(e){return null===e}function Gr(e){return null==e}function Xr(e){return"number"==typeof e}function Zr(e){return"string"==typeof e}function Qr(t){return"symbol"===e(t)}function en(e){return void 0===e}function tn(e){return rn(e)&&"[object RegExp]"===cn(e)}function rn(t){return"object"===e(t)&&null!==t}function nn(e){return rn(e)&&"[object Date]"===cn(e)}function on(e){return rn(e)&&("[object Error]"===cn(e)||e instanceof Error)}function sn(e){return"function"==typeof e}function an(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"===e(t)||void 0===t}function un(e){return Buffer.isBuffer(e)}function cn(e){return Object.prototype.toString.call(e)}function fn(e){return e<10?"0"+e.toString(10):e.toString(10)}qr.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},qr.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var ln=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function hn(){var e=new Date,t=[fn(e.getHours()),fn(e.getMinutes()),fn(e.getSeconds())].join(":");return[e.getDate(),ln[e.getMonth()],t].join(" ")}function pn(){console.log("%s - %s",hn(),Lr.apply(null,arguments))}function dn(e,t){if(!t||!rn(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function vn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var yn={inherits:Nr,_extend:dn,log:pn,isBuffer:un,isPrimitive:an,isFunction:sn,isError:on,isDate:nn,isObject:rn,isRegExp:tn,isUndefined:en,isSymbol:Qr,isString:Zr,isNumber:Xr,isNullOrUndefined:Gr,isNull:Jr,isBoolean:Kr,isArray:Wr,inspect:qr,deprecate:Ir,format:Lr,debuglog:Ur},gn=Object.freeze({__proto__:null,format:Lr,deprecate:Ir,debuglog:Ur,inspect:qr,isArray:Wr,isBoolean:Kr,isNull:Jr,isNullOrUndefined:Gr,isNumber:Xr,isString:Zr,isSymbol:Qr,isUndefined:en,isRegExp:tn,isObject:rn,isDate:nn,isError:on,isFunction:sn,isPrimitive:an,isBuffer:un,log:pn,inherits:Nr,_extend:dn,default:yn});function mn(){this.head=null,this.tail=null,this.length=0}mn.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},mn.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},mn.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},mn.prototype.clear=function(){this.head=this.tail=null,this.length=0},mn.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},mn.prototype.concat=function(e){if(0===this.length)return Bt.alloc(0);if(1===this.length)return this.head.data;for(var t=Bt.allocUnsafe(e>>>0),r=this.head,n=0;r;)r.data.copy(t,n),n+=r.data.length,r=r.next;return t};var bn={exports:{}};!function(e,t){var r=br,n=r.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o),o.prototype=Object.create(n.prototype),i(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(bn,bn.exports);var wn=bn.exports.Buffer,kn=wn.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};var Sn=En;function En(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(wn.isEncoding===kn||!kn(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=Rn,this.end=An,t=4;break;case"utf8":this.fillLast=Cn,t=4;break;case"base64":this.text=Tn,this.end=xn,t=3;break;default:return this.write=jn,void(this.end=On)}this.lastNeed=0,this.lastTotal=0,this.lastChar=wn.allocUnsafe(t)}function _n(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function Cn(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function Rn(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function An(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function Tn(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function xn(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function jn(e){return e.toString(this.encoding)}function On(e){return e&&e.length?this.write(e):""}En.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},En.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},En.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=_n(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if((i=_n(t[n]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if((i=_n(t[n]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},En.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},Nn.ReadableState=Bn;var Pn=Ur("stream");function Bn(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof ui&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new mn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new Sn(e.encoding),this.encoding=e.encoding)}function Nn(e){if(!(this instanceof Nn))return new Nn(e);this._readableState=new Bn(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),yt.call(this)}function Mn(e,t,r,n,i){var o=function(e,t){var r=null;Buffer.isBuffer(t)||"string"==typeof t||null==t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));return r}(t,r);if(o)e.emit("error",o);else if(null===r)t.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,Fn(e)}(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&i){var a=new Error("stream.unshift() after end event");e.emit("error",a)}else{var u;!t.decoder||i||n||(r=t.decoder.write(r),u=!t.objectMode&&0===r.length),i||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&Fn(e))),function(e,t){t.readingMore||(t.readingMore=!0,Or(Un,e,t))}(e,t)}else i||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}Nr(Nn,yt),Nn.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=Buffer.from(e,t),t=""),Mn(this,r,e,t,!1)},Nn.prototype.unshift=function(e){return Mn(this,this._readableState,e,"",!0)},Nn.prototype.isPaused=function(){return!1===this._readableState.flowing},Nn.prototype.setEncoding=function(e){return this._readableState.decoder=new Sn(e),this._readableState.encoding=e,this};var Ln=8388608;function In(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=Ln?e=Ln:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function Fn(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Pn("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?Or(Dn,e):Dn(e))}function Dn(e){Pn("emit readable"),e.emit("readable"),Vn(e)}function Un(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Pn("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function qn(e){Pn("readable nexttick read 0"),e.read(0)}function Yn(e,t){t.reading||(Pn("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),Vn(e),t.flowing&&!t.reading&&e.read(0)}function Vn(e){var t=e._readableState;for(Pn("flow",t.flowing);t.flowing&&null!==e.read(););}function zn(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0===(e-=s)){s===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=Buffer.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0===(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function $n(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,Or(Hn,t,e))}function Hn(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function Wn(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function Kn(){}function Jn(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function Gn(e,t){Object.defineProperty(this,"buffer",{get:Ir((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof ui&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?Or(i,n):i(n);e._writableState.errorEmitted=!0,e.emit("error",n)}(e,r,n,t,i);else{var o=ti(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||ei(e,r),n?Or(Qn,e,r,o,i):Qn(e,r,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new ii(this)}function Xn(e){if(!(this instanceof Xn||this instanceof ui))return new Xn(e);this._writableState=new Gn(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),tt.exports.EventEmitter.call(this)}function Zn(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function Qn(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),ni(e,t)}function ei(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0;r;)i[s]=r,r=r.next,s+=1;Zn(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new ii(t)}else{for(;r;){var a=r.chunk,u=r.encoding,c=r.callback;if(Zn(e,t,!1,t.objectMode?1:a.length,a,u,c),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function ti(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function ri(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function ni(e,t){var r=ti(t);return r&&(0===t.pendingcb?(ri(e,t),t.finished=!0,e.emit("finish")):ri(e,t)),r}function ii(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}Nn.prototype.read=function(e){Pn("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Pn("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?$n(this):Fn(this),null;if(0===(e=In(e,t))&&t.ended)return 0===t.length&&$n(this),null;var n,i=t.needReadable;return Pn("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&Pn("length less than watermark",i=!0),t.ended||t.reading?Pn("reading or ended",i=!1):i&&(Pn("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=In(r,t))),null===(n=e>0?zn(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&$n(this)),null!==n&&this.emit("data",n),n},Nn.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Nn.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,Pn("pipe count=%d opts=%j",n.pipesCount,t);var i=!t||!1!==t.end?s:c;function o(e){Pn("onunpipe"),e===r&&c()}function s(){Pn("onend"),e.end()}n.endEmitted?Or(i):r.once("end",i),e.on("unpipe",o);var a=function(e){return function(){var t=e._readableState;Pn("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,Vn(e))}}(r);e.on("drain",a);var u=!1;function c(){Pn("cleanup"),e.removeListener("close",p),e.removeListener("finish",d),e.removeListener("drain",a),e.removeListener("error",h),e.removeListener("unpipe",o),r.removeListener("end",s),r.removeListener("end",c),r.removeListener("data",l),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||a()}var f=!1;function l(t){Pn("ondata"),f=!1,!1!==e.write(t)||f||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==Wn(n.pipes,e))&&!u&&(Pn("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,f=!0),r.pause())}function h(t){var r;Pn("onerror",t),v(),e.removeListener("error",h),0===(r="error",e.listeners(r).length)&&e.emit("error",t)}function p(){e.removeListener("finish",d),v()}function d(){Pn("onfinish"),e.removeListener("close",p),v()}function v(){Pn("unpipe"),r.unpipe(e)}return r.on("data",l),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",h),e.once("close",p),e.once("finish",d),e.emit("pipe",r),n.flowing||(Pn("pipe resume"),r.resume()),e},Nn.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var o=Wn(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},Nn.prototype.on=function(e,t){var r=yt.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&Fn(this):Or(qn,this))}return r},Nn.prototype.addListener=Nn.prototype.on,Nn.prototype.resume=function(){var e=this._readableState;return e.flowing||(Pn("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,Or(Yn,e,t))}(this,e)),this},Nn.prototype.pause=function(){return Pn("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Pn("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Nn.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",(function(){if(Pn("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(i){(Pn("wrapped data"),t.decoder&&(i=t.decoder.write(i)),t.objectMode&&null==i)||(t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return function(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}(["error","close","destroy","pause","resume"],(function(t){e.on(t,n.emit.bind(n,t))})),n._read=function(t){Pn("wrapped _read",t),r&&(r=!1,e.resume())},n},Nn._fromList=zn,Xn.WritableState=Gn,Nr(Xn,tt.exports.EventEmitter),Gn.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Xn.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Xn.prototype.write=function(e,t,r){var n=this._writableState,i=!1;return"function"==typeof t&&(r=t,t=null),Bt.isBuffer(e)?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=Kn),n.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),Or(t,r)}(this,r):function(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):Bt.isBuffer(r)||"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),Or(n,o),i=!1),i}(this,n,e,r)&&(n.pendingcb++,i=function(e,t,r,n,i){r=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Bt.from(t,r));return t}(t,r,n),Bt.isBuffer(r)&&(n="buffer");var o=t.objectMode?1:r.length;t.length+=o;var s=t.length<t.highWaterMark;s||(t.needDrain=!0);if(t.writing||t.corked){var a=t.lastBufferedRequest;t.lastBufferedRequest=new Jn(r,n,i),a?a.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else Zn(e,t,!1,o,r,n,i);return s}(this,n,e,t,r)),i},Xn.prototype.cork=function(){this._writableState.corked++},Xn.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||ei(this,e))},Xn.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Xn.prototype._write=function(e,t,r){r(new Error("not implemented"))},Xn.prototype._writev=null,Xn.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,ni(e,t),r&&(t.finished?Or(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},Nr(ui,Nn);for(var oi=Object.keys(Xn.prototype),si=0;si<oi.length;si++){var ai=oi[si];ui.prototype[ai]||(ui.prototype[ai]=Xn.prototype[ai])}function ui(e){if(!(this instanceof ui))return new ui(e);Nn.call(this,e),Xn.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",ci)}function ci(){this.allowHalfOpen||this._writableState.ended||Or(fi,this)}function fi(e){e.end()}function li(e){this.afterTransform=function(t,r){return function(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=r&&e.push(r);i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function hi(e){if(!(this instanceof hi))return new hi(e);ui.call(this,e),this._transformState=new li(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e){pi(t,e)})):pi(t)}))}function pi(e,t){if(t)return e.emit("error",t);var r=e._writableState,n=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function di(e){if(!(this instanceof di))return new di(e);hi.call(this,e)}function vi(){yt.call(this)}Nr(hi,ui),hi.prototype.push=function(e,t){return this._transformState.needTransform=!1,ui.prototype.push.call(this,e,t)},hi.prototype._transform=function(e,t,r){throw new Error("Not implemented")},hi.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},hi.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Nr(di,hi),di.prototype._transform=function(e,t,r){r(null,e)},Nr(vi,yt),vi.Readable=Nn,vi.Writable=Xn,vi.Duplex=ui,vi.Transform=hi,vi.PassThrough=di,vi.Stream=vi,vi.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",a));var o=!1;function s(){o||(o=!0,e.end())}function a(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===yt.listenerCount(this,"error"))throw e}function c(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",s),r.removeListener("close",a),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return r.on("error",u),e.on("error",u),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e};var yi=w(Object.freeze({__proto__:null,default:vi,Readable:Nn,Writable:Xn,Duplex:ui,Transform:hi,PassThrough:di,Stream:vi})),gi=w(gn),mi=mt.exports.Buffer,bi=yi;function wi(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=mi.alloc(0),this;if("function"==typeof t.pipe)return this.buffer=mi.alloc(0),t.pipe(this),this;if(t.length||"object"===e(t))return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+e(t)+")")}gi.inherits(wi,bi),wi.prototype.write=function(e){this.buffer=mi.concat([this.buffer,mi.from(e)]),this.emit("data",e)},wi.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};var ki=wi,Si=br.Buffer,Ei=br.SlowBuffer,_i=Ci;function Ci(e,t){if(!Si.isBuffer(e)||!Si.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}Ci.install=function(){Si.prototype.equal=Ei.prototype.equal=function(e){return Ci(this,e)}};var Ri=Si.prototype.equal,Ai=Ei.prototype.equal;Ci.restore=function(){Si.prototype.equal=Ri,Ei.prototype.equal=Ai};var Ti=w(Object.freeze({__proto__:null,default:{}}));function xi(e){return(e/8|0)+(e%8==0?0:1)}var ji={ES256:xi(256),ES384:xi(384),ES512:xi(521)};var Oi=function(e){var t=ji[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')},Pi=mt.exports.Buffer,Bi=Oi,Ni=128;function Mi(e){if(Pi.isBuffer(e))return e;if("string"==typeof e)return Pi.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function Li(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=Ni&&--n,n}var Ii={derToJose:function(e,t){e=Mi(e);var r=Bi(t),n=r+1,i=e.length,o=0;if(48!==e[o++])throw new Error('Could not find expected "seq"');var s=e[o++];if(129===s&&(s=e[o++]),i-o<s)throw new Error('"seq" specified length of "'+s+'", only "'+(i-o)+'" remaining');if(2!==e[o++])throw new Error('Could not find expected "int" for "r"');var a=e[o++];if(i-o-2<a)throw new Error('"r" specified length of "'+a+'", only "'+(i-o-2)+'" available');if(n<a)throw new Error('"r" specified length of "'+a+'", max of "'+n+'" is acceptable');var u=o;if(o+=a,2!==e[o++])throw new Error('Could not find expected "int" for "s"');var c=e[o++];if(i-o!==c)throw new Error('"s" specified length of "'+c+'", expected "'+(i-o)+'"');if(n<c)throw new Error('"s" specified length of "'+c+'", max of "'+n+'" is acceptable');var f=o;if((o+=c)!==i)throw new Error('Expected to consume entire buffer, but "'+(i-o)+'" bytes remain');var l=r-a,h=r-c,p=Pi.allocUnsafe(l+a+h+c);for(o=0;o<l;++o)p[o]=0;e.copy(p,o,u+Math.max(-l,0),u+a);for(var d=o=r;o<d+h;++o)p[o]=0;return e.copy(p,o,f+Math.max(-h,0),f+c),p=(p=p.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=Mi(e);var r=Bi(t),n=e.length;if(n!==2*r)throw new TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+n+'"');var i=Li(e,0,r),o=Li(e,r,e.length),s=r-i,a=r-o,u=2+s+1+1+a,c=u<Ni,f=Pi.allocUnsafe((c?2:3)+u),l=0;return f[l++]=48,c?f[l++]=u:(f[l++]=129,f[l++]=255&u),f[l++]=2,f[l++]=s,i<0?(f[l++]=0,l+=e.copy(f,l,0,r)):l+=e.copy(f,l,i,r),f[l++]=2,f[l++]=a,o<0?(f[l++]=0,e.copy(f,l,r)):e.copy(f,l,r+o),f}},Fi=_i,Di=mt.exports.Buffer,Ui=Ti,qi=Ii,Yi=gi,Vi="secret must be a string or buffer",zi="key must be a string or a buffer",$i="function"==typeof Ui.createPublicKey;function Hi(t){if(!Di.isBuffer(t)&&"string"!=typeof t){if(!$i)throw Gi(zi);if("object"!==e(t))throw Gi(zi);if("string"!=typeof t.type)throw Gi(zi);if("string"!=typeof t.asymmetricKeyType)throw Gi(zi);if("function"!=typeof t.export)throw Gi(zi)}}function Wi(t){if(!Di.isBuffer(t)&&"string"!=typeof t&&"object"!==e(t))throw Gi("key must be a string, a buffer or an object")}function Ki(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ji(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function Gi(e){var t=[].slice.call(arguments,1),r=Yi.format.bind(Yi,e).apply(null,t);return new TypeError(r)}function Xi(e){var t;return t=e,Di.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function Zi(t){return function(r,n){!function(t){if(!Di.isBuffer(t)){if("string"==typeof t)return t;if(!$i)throw Gi(Vi);if("object"!==e(t))throw Gi(Vi);if("secret"!==t.type)throw Gi(Vi);if("function"!=typeof t.export)throw Gi(Vi)}}(n),r=Xi(r);var i=Ui.createHmac("sha"+t,n);return Ki((i.update(r),i.digest("base64")))}}function Qi(e){return function(t,r,n){var i=Zi(e)(t,n);return Fi(Di.from(r),Di.from(i))}}function eo(e){return function(t,r){Wi(r),t=Xi(t);var n=Ui.createSign("RSA-SHA"+e);return Ki((n.update(t),n.sign(r,"base64")))}}function to(e){return function(t,r,n){Hi(n),t=Xi(t),r=Ji(r);var i=Ui.createVerify("RSA-SHA"+e);return i.update(t),i.verify(n,r,"base64")}}function ro(e){return function(t,r){Wi(r),t=Xi(t);var n=Ui.createSign("RSA-SHA"+e);return Ki((n.update(t),n.sign({key:r,padding:Ui.constants.RSA_PKCS1_PSS_PADDING,saltLength:Ui.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function no(e){return function(t,r,n){Hi(n),t=Xi(t),r=Ji(r);var i=Ui.createVerify("RSA-SHA"+e);return i.update(t),i.verify({key:n,padding:Ui.constants.RSA_PKCS1_PSS_PADDING,saltLength:Ui.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function io(e){var t=eo(e);return function(){var r=t.apply(null,arguments);return r=qi.derToJose(r,"ES"+e)}}function oo(e){var t=to(e);return function(r,n,i){return n=qi.joseToDer(n,"ES"+e).toString("base64"),t(r,n,i)}}function so(){return function(){return""}}function ao(){return function(e,t){return""===t}}$i&&(zi+=" or a KeyObject",Vi+="or a KeyObject");var uo=function(e){var t={hs:Zi,rs:eo,ps:ro,es:io,none:so},r={hs:Qi,rs:to,ps:no,es:oo,none:ao},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw Gi('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var i=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:t[i](o),verify:r[i](o)}},co=br.Buffer,fo=function(e){return"string"==typeof e?e:"number"==typeof e||co.isBuffer(e)?e.toString():JSON.stringify(e)},lo=mt.exports.Buffer,ho=ki,po=uo,vo=yi,yo=fo,go=gi;function mo(e,t){return lo.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function bo(e){var t=e.header,r=e.payload,n=e.secret||e.privateKey,i=e.encoding,o=po(t.alg),s=function(e,t,r){r=r||"utf8";var n=mo(yo(e),"binary"),i=mo(yo(t),r);return go.format("%s.%s",n,i)}(t,r,i),a=o.sign(s,n);return go.format("%s.%s",s,a)}function wo(e){var t=e.secret||e.privateKey||e.key,r=new ho(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new ho(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}go.inherits(wo,vo),wo.prototype.sign=function(){try{var e=bo({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},wo.sign=bo;var ko=wo,So=mt.exports.Buffer,Eo=ki,_o=uo,Co=yi,Ro=fo,Ao=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function To(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}function xo(e){var t=e.split(".",1)[0];return To(So.from(t,"base64").toString("binary"))}function jo(e){return e.split(".")[2]}function Oo(e){return Ao.test(e)&&!!xo(e)}function Po(e,t,r){if(!t){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=jo(e=Ro(e)),o=function(e){return e.split(".",2).join(".")}(e);return _o(t).verify(o,i,r)}function Bo(e,t){if(t=t||{},!Oo(e=Ro(e)))return null;var r=xo(e);if(!r)return null;var n=function(e,t){t=t||"utf8";var r=e.split(".")[1];return So.from(r,"base64").toString(t)}(e);return("JWT"===r.typ||t.json)&&(n=JSON.parse(n,t.encoding)),{header:r,payload:n,signature:jo(e)}}function No(e){var t=(e=e||{}).secret||e.publicKey||e.key,r=new Eo(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new Eo(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}gi.inherits(No,Co),No.prototype.verify=function(){try{var e=Po(this.signature.buffer,this.algorithm,this.key.buffer),t=Bo(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},No.decode=Bo,No.isValid=Oo,No.verify=Po;var Mo=ko,Lo=No;gt.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],gt.sign=Mo.sign,gt.verify=Lo.verify,gt.decode=Lo.decode,gt.isValid=Lo.isValid,gt.createSign=function(e){return new Mo(e)},gt.createVerify=function(e){return new Lo(e)};var Io=gt,Fo=function(t,r){r=r||{};var n=Io.decode(t,r);if(!n)return null;var i=n.payload;if("string"==typeof i)try{var o=JSON.parse(i);null!==o&&"object"===e(o)&&(i=o)}catch(e){}return!0===r.complete?{header:n.header,payload:i,signature:n.signature}:i},Do=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(Do.prototype=Object.create(Error.prototype)).constructor=Do;var Uo=Do,qo=Uo,Yo=function(e,t){qo.call(this,e),this.name="NotBeforeError",this.date=t};(Yo.prototype=Object.create(qo.prototype)).constructor=Yo;var Vo=Yo,zo=Uo,$o=function(e,t){zo.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};($o.prototype=Object.create(zo.prototype)).constructor=$o;var Ho=$o,Wo=We,Ko=function(e,t){var r=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var n=Wo(e);if(void 0===n)return;return Math.floor(r+n/1e3)}return"number"==typeof e?r+e:void 0},Jo={exports:{}};!function(t,r){var n;r=t.exports=W,n="object"===("undefined"==typeof process?"undefined":e(process))&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},r.SEMVER_SPEC_VERSION="2.0.0";var i=Number.MAX_SAFE_INTEGER||9007199254740991,o=r.re=[],s=r.src=[],a=0,u=a++;s[u]="0|[1-9]\\d*";var c=a++;s[c]="[0-9]+";var f=a++;s[f]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var l=a++;s[l]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var h=a++;s[h]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var p=a++;s[p]="(?:"+s[u]+"|"+s[f]+")";var d=a++;s[d]="(?:"+s[c]+"|"+s[f]+")";var v=a++;s[v]="(?:-("+s[p]+"(?:\\."+s[p]+")*))";var y=a++;s[y]="(?:-?("+s[d]+"(?:\\."+s[d]+")*))";var g=a++;s[g]="[0-9A-Za-z-]+";var m=a++;s[m]="(?:\\+("+s[g]+"(?:\\."+s[g]+")*))";var b=a++,w="v?"+s[l]+s[v]+"?"+s[m]+"?";s[b]="^"+w+"$";var k="[v=\\s]*"+s[h]+s[y]+"?"+s[m]+"?",S=a++;s[S]="^"+k+"$";var E=a++;s[E]="((?:<|>)?=?)";var _=a++;s[_]=s[c]+"|x|X|\\*";var C=a++;s[C]=s[u]+"|x|X|\\*";var R=a++;s[R]="[v=\\s]*("+s[C]+")(?:\\.("+s[C]+")(?:\\.("+s[C]+")(?:"+s[v]+")?"+s[m]+"?)?)?";var A=a++;s[A]="[v=\\s]*("+s[_]+")(?:\\.("+s[_]+")(?:\\.("+s[_]+")(?:"+s[y]+")?"+s[m]+"?)?)?";var T=a++;s[T]="^"+s[E]+"\\s*"+s[R]+"$";var x=a++;s[x]="^"+s[E]+"\\s*"+s[A]+"$";var j=a++;s[j]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var O=a++;s[O]="(?:~>?)";var P=a++;s[P]="(\\s*)"+s[O]+"\\s+",o[P]=new RegExp(s[P],"g");var B=a++;s[B]="^"+s[O]+s[R]+"$";var N=a++;s[N]="^"+s[O]+s[A]+"$";var M=a++;s[M]="(?:\\^)";var L=a++;s[L]="(\\s*)"+s[M]+"\\s+",o[L]=new RegExp(s[L],"g");var I=a++;s[I]="^"+s[M]+s[R]+"$";var F=a++;s[F]="^"+s[M]+s[A]+"$";var D=a++;s[D]="^"+s[E]+"\\s*("+k+")$|^$";var U=a++;s[U]="^"+s[E]+"\\s*("+w+")$|^$";var q=a++;s[q]="(\\s*)"+s[E]+"\\s*("+k+"|"+s[R]+")",o[q]=new RegExp(s[q],"g");var Y=a++;s[Y]="^\\s*("+s[R]+")\\s+-\\s+("+s[R]+")\\s*$";var V=a++;s[V]="^\\s*("+s[A]+")\\s+-\\s+("+s[A]+")\\s*$";var z=a++;s[z]="(<|>)?=?\\s*\\*";for(var $=0;$<35;$++)n($,s[$]),o[$]||(o[$]=new RegExp(s[$]));function H(t,r){if(r&&"object"===e(r)||(r={loose:!!r,includePrerelease:!1}),t instanceof W)return t;if("string"!=typeof t)return null;if(t.length>256)return null;if(!(r.loose?o[S]:o[b]).test(t))return null;try{return new W(t,r)}catch(e){return null}}function W(t,r){if(r&&"object"===e(r)||(r={loose:!!r,includePrerelease:!1}),t instanceof W){if(t.loose===r.loose)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: "+t);if(t.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof W))return new W(t,r);n("SemVer",t,r),this.options=r,this.loose=!!r.loose;var s=t.trim().match(r.loose?o[S]:o[b]);if(!s)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}r.parse=H,r.valid=function(e,t){var r=H(e,t);return r?r.version:null},r.clean=function(e,t){var r=H(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},r.SemVer=W,W.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},W.prototype.toString=function(){return this.version},W.prototype.compare=function(e){return n("SemVer.compare",this.version,this.options,e),e instanceof W||(e=new W(e,this.options)),this.compareMain(e)||this.comparePre(e)},W.prototype.compareMain=function(e){return e instanceof W||(e=new W(e,this.options)),J(this.major,e.major)||J(this.minor,e.minor)||J(this.patch,e.patch)},W.prototype.comparePre=function(e){if(e instanceof W||(e=new W(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return J(r,i)}while(++t)},W.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},r.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new W(e,r).inc(t,n).version}catch(e){return null}},r.diff=function(e,t){if(Q(e,t))return null;var r=H(e),n=H(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in r)if(("major"===s||"minor"===s||"patch"===s)&&r[s]!==n[s])return i+s;return o},r.compareIdentifiers=J;var K=/^[0-9]+$/;function J(e,t){var r=K.test(e),n=K.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function G(e,t,r){return new W(e,r).compare(new W(t,r))}function X(e,t,r){return G(e,t,r)>0}function Z(e,t,r){return G(e,t,r)<0}function Q(e,t,r){return 0===G(e,t,r)}function ee(e,t,r){return 0!==G(e,t,r)}function te(e,t,r){return G(e,t,r)>=0}function re(e,t,r){return G(e,t,r)<=0}function ne(t,r,n,i){switch(r){case"===":return"object"===e(t)&&(t=t.version),"object"===e(n)&&(n=n.version),t===n;case"!==":return"object"===e(t)&&(t=t.version),"object"===e(n)&&(n=n.version),t!==n;case"":case"=":case"==":return Q(t,n,i);case"!=":return ee(t,n,i);case">":return X(t,n,i);case">=":return te(t,n,i);case"<":return Z(t,n,i);case"<=":return re(t,n,i);default:throw new TypeError("Invalid operator: "+r)}}function ie(t,r){if(r&&"object"===e(r)||(r={loose:!!r,includePrerelease:!1}),t instanceof ie){if(t.loose===!!r.loose)return t;t=t.value}if(!(this instanceof ie))return new ie(t,r);n("comparator",t,r),this.options=r,this.loose=!!r.loose,this.parse(t),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,n("comp",this)}r.rcompareIdentifiers=function(e,t){return J(t,e)},r.major=function(e,t){return new W(e,t).major},r.minor=function(e,t){return new W(e,t).minor},r.patch=function(e,t){return new W(e,t).patch},r.compare=G,r.compareLoose=function(e,t){return G(e,t,!0)},r.rcompare=function(e,t,r){return G(t,e,r)},r.sort=function(e,t){return e.sort((function(e,n){return r.compare(e,n,t)}))},r.rsort=function(e,t){return e.sort((function(e,n){return r.rcompare(e,n,t)}))},r.gt=X,r.lt=Z,r.eq=Q,r.neq=ee,r.gte=te,r.lte=re,r.cmp=ne,r.Comparator=ie;var oe={};function se(t,r){if(r&&"object"===e(r)||(r={loose:!!r,includePrerelease:!1}),t instanceof se)return t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease?t:new se(t.raw,r);if(t instanceof ie)return new se(t.value,r);if(!(this instanceof se))return new se(t,r);if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function ue(e,t,r,n,i,o,s,a,u,c,f,l,h){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(i)?">="+r+"."+n+".0":">="+t)+" "+(a=ae(u)?"":ae(c)?"<"+(+u+1)+".0.0":ae(f)?"<"+u+"."+(+c+1)+".0":l?"<="+u+"."+c+"."+f+"-"+l:"<="+a)).trim()}function ce(e,t,r){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(i=0;i<e.length;i++)if(n(e[i].semver),e[i].semver!==oe&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function fe(e,t,r){try{t=new se(t,r)}catch(e){return!1}return t.test(e)}function le(e,t,r,n){var i,o,s,a,u;switch(e=new W(e,n),t=new se(t,n),r){case">":i=X,o=re,s=Z,a=">",u=">=";break;case"<":i=Z,o=te,s=X,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(fe(e,t,n))return!1;for(var c=0;c<t.set.length;++c){var f=t.set[c],l=null,h=null;if(f.forEach((function(e){e.semver===oe&&(e=new ie(">=0.0.0")),l=l||e,h=h||e,i(e.semver,l.semver,n)?l=e:s(e.semver,h.semver,n)&&(h=e)})),l.operator===a||l.operator===u)return!1;if((!h.operator||h.operator===a)&&o(e,h.semver))return!1;if(h.operator===u&&s(e,h.semver))return!1}return!0}ie.prototype.parse=function(e){var t=this.options.loose?o[D]:o[U],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new W(r[2],this.options.loose):this.semver=oe},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return n("Comparator.test",e,this.options.loose),this.semver===oe||("string"==typeof e&&(e=new W(e,this.options)),ne(e,this.operator,this.semver,this.options))},ie.prototype.intersects=function(t,r){if(!(t instanceof ie))throw new TypeError("a Comparator is required");var n;if(r&&"object"===e(r)||(r={loose:!!r,includePrerelease:!1}),""===this.operator)return n=new se(t.value,r),fe(this.value,n,r);if(""===t.operator)return n=new se(this.value,r),fe(t.semver,n,r);var i=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),s=this.semver.version===t.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),u=ne(this.semver,"<",t.semver,r)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),c=ne(this.semver,">",t.semver,r)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return i||o||s&&a||u||c},r.Range=se,se.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},se.prototype.toString=function(){return this.range},se.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var r=t?o[V]:o[Y];e=e.replace(r,ue),n("hyphen replace",e),e=e.replace(o[q],"$1$2$3"),n("comparator trim",e,o[q]),e=(e=(e=e.replace(o[P],"$1~")).replace(o[L],"$1^")).split(/\s+/).join(" ");var i=t?o[D]:o[U],s=e.split(" ").map((function(e){return function(e,t){return n("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){n("caret",e,t);var r=t.loose?o[F]:o[I];return e.replace(r,(function(t,r,i,o,s){var a;return n("caret",e,t,r,i,o,s),ae(r)?a="":ae(i)?a=">="+r+".0.0 <"+(+r+1)+".0.0":ae(o)?a="0"===r?">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0":">="+r+"."+i+".0 <"+(+r+1)+".0.0":s?(n("replaceCaret pr",s),a="0"===r?"0"===i?">="+r+"."+i+"."+o+"-"+s+" <"+r+"."+i+"."+(+o+1):">="+r+"."+i+"."+o+"-"+s+" <"+r+"."+(+i+1)+".0":">="+r+"."+i+"."+o+"-"+s+" <"+(+r+1)+".0.0"):(n("no pr"),a="0"===r?"0"===i?">="+r+"."+i+"."+o+" <"+r+"."+i+"."+(+o+1):">="+r+"."+i+"."+o+" <"+r+"."+(+i+1)+".0":">="+r+"."+i+"."+o+" <"+(+r+1)+".0.0"),n("caret return",a),a}))}(e,t)})).join(" ")}(e,t),n("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var r=t.loose?o[N]:o[B];return e.replace(r,(function(t,r,i,o,s){var a;return n("tilde",e,t,r,i,o,s),ae(r)?a="":ae(i)?a=">="+r+".0.0 <"+(+r+1)+".0.0":ae(o)?a=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0":s?(n("replaceTilde pr",s),a=">="+r+"."+i+"."+o+"-"+s+" <"+r+"."+(+i+1)+".0"):a=">="+r+"."+i+"."+o+" <"+r+"."+(+i+1)+".0",n("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),n("tildes",e),e=function(e,t){return n("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var r=t.loose?o[x]:o[T];return e.replace(r,(function(t,r,i,o,s,a){n("xRange",e,t,r,i,o,s,a);var u=ae(i),c=u||ae(o),f=c||ae(s);return"="===r&&f&&(r=""),u?t=">"===r||"<"===r?"<0.0.0":"*":r&&f?(c&&(o=0),s=0,">"===r?(r=">=",c?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===r&&(r="<",c?i=+i+1:o=+o+1),t=r+i+"."+o+"."+s):c?t=">="+i+".0.0 <"+(+i+1)+".0.0":f&&(t=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"),n("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),n("xrange",e),e=function(e,t){return n("replaceStars",e,t),e.trim().replace(o[z],"")}(e,t),n("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(s=s.filter((function(e){return!!e.match(i)}))),s=s.map((function(e){return new ie(e,this.options)}),this)},se.prototype.intersects=function(e,t){if(!(e instanceof se))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},r.toComparators=function(e,t){return new se(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},se.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new W(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},r.satisfies=fe,r.maxSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch(e){return null}return e.forEach((function(e){o.test(e)&&(n&&-1!==i.compare(e)||(i=new W(n=e,r)))})),n},r.minSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch(e){return null}return e.forEach((function(e){o.test(e)&&(n&&1!==i.compare(e)||(i=new W(n=e,r)))})),n},r.minVersion=function(e,t){e=new se(e,t);var r=new W("0.0.0");if(e.test(r))return r;if(r=new W("0.0.0-0"),e.test(r))return r;r=null;for(var n=0;n<e.set.length;++n){e.set[n].forEach((function(e){var t=new W(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!X(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(r&&e.test(r))return r;return null},r.validRange=function(e,t){try{return new se(e,t).range||"*"}catch(e){return null}},r.ltr=function(e,t,r){return le(e,t,"<",r)},r.gtr=function(e,t,r){return le(e,t,">",r)},r.outside=le,r.prerelease=function(e,t){var r=H(e,t);return r&&r.prerelease.length?r.prerelease:null},r.intersects=function(e,t,r){return e=new se(e,r),t=new se(t,r),e.intersects(t)},r.coerce=function(e){if(e instanceof W)return e;if("string"!=typeof e)return null;var t=e.match(o[j]);if(null==t)return null;return H(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}}(Jo,Jo.exports);var Go=Jo.exports.satisfies(process.version,"^6.12.0 || >=8.0.0"),Xo=Uo,Zo=Vo,Qo=Ho,es=Fo,ts=Ko,rs=gt,ns=["RS256","RS384","RS512","ES256","ES384","ES512"],is=["RS256","RS384","RS512"],os=["HS256","HS384","HS512"];Go&&(ns.splice(3,0,"PS256","PS384","PS512"),is.splice(3,0,"PS256","PS384","PS512"));var ss=1/0,as=9007199254740991,us=17976931348623157e292,cs=NaN,fs="[object Arguments]",ls="[object Function]",hs="[object GeneratorFunction]",ps="[object String]",ds="[object Symbol]",vs=/^\s+|\s+$/g,ys=/^[-+]0x[0-9a-f]+$/i,gs=/^0b[01]+$/i,ms=/^0o[0-7]+$/i,bs=/^(?:0|[1-9]\d*)$/,ws=parseInt;function ks(e){return e!=e}function Ss(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(t,(function(t){return e[t]}))}var Es,_s,Cs=Object.prototype,Rs=Cs.hasOwnProperty,As=Cs.toString,Ts=Cs.propertyIsEnumerable,xs=(Es=Object.keys,_s=Object,function(e){return Es(_s(e))}),js=Math.max;function Os(e,t){var r=Ns(e)||function(e){return function(e){return Is(e)&&Ms(e)}(e)&&Rs.call(e,"callee")&&(!Ts.call(e,"callee")||As.call(e)==fs)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var o in e)!t&&!Rs.call(e,o)||i&&("length"==o||Bs(o,n))||r.push(o);return r}function Ps(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||Cs,t!==n)return xs(e);var t,r,n,i=[];for(var o in Object(e))Rs.call(e,o)&&"constructor"!=o&&i.push(o);return i}function Bs(e,t){return!!(t=null==t?as:t)&&("number"==typeof e||bs.test(e))&&e>-1&&e%1==0&&e<t}var Ns=Array.isArray;function Ms(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=as}(e.length)&&!function(e){var t=Ls(e)?As.call(e):"";return t==ls||t==hs}(e)}function Ls(t){var r=e(t);return!!t&&("object"==r||"function"==r)}function Is(t){return!!t&&"object"==e(t)}var Fs=function(t,r,n,i){var o;t=Ms(t)?t:(o=t)?Ss(o,function(e){return Ms(e)?Os(e):Ps(e)}(o)):[],n=n&&!i?function(t){var r=function(t){if(!t)return 0===t?t:0;if(t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==e(t)||Is(t)&&As.call(t)==ds}(t))return cs;if(Ls(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=Ls(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(vs,"");var n=gs.test(t);return n||ms.test(t)?ws(t.slice(2),n?2:8):ys.test(t)?cs:+t}(t),t===ss||t===-1/0){return(t<0?-1:1)*us}return t==t?t:0}(t),n=r%1;return r==r?n?r-n:r:0}(n):0;var s=t.length;return n<0&&(n=js(s+n,0)),function(e){return"string"==typeof e||!Ns(e)&&Is(e)&&As.call(e)==ps}(t)?n<=s&&t.indexOf(r,n)>-1:!!s&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,ks,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(t,r,n)>-1},Ds=Object.prototype.toString;var Us=function(t){return!0===t||!1===t||function(t){return!!t&&"object"==e(t)}(t)&&"[object Boolean]"==Ds.call(t)},qs=1/0,Ys=17976931348623157e292,Vs=NaN,zs="[object Symbol]",$s=/^\s+|\s+$/g,Hs=/^[-+]0x[0-9a-f]+$/i,Ws=/^0b[01]+$/i,Ks=/^0o[0-7]+$/i,Js=parseInt,Gs=Object.prototype.toString;function Xs(t){var r=e(t);return!!t&&("object"==r||"function"==r)}var Zs=function(t){return"number"==typeof t&&t==function(t){var r=function(t){if(!t)return 0===t?t:0;if(t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==e(t)||function(t){return!!t&&"object"==e(t)}(t)&&Gs.call(t)==zs}(t))return Vs;if(Xs(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=Xs(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=t.replace($s,"");var n=Ws.test(t);return n||Ks.test(t)?Js(t.slice(2),n?2:8):Hs.test(t)?Vs:+t}(t),t===qs||t===-1/0){return(t<0?-1:1)*Ys}return t==t?t:0}(t),n=r%1;return r==r?n?r-n:r:0}(t)},Qs=Object.prototype.toString;var ea=function(t){return"number"==typeof t||function(t){return!!t&&"object"==e(t)}(t)&&"[object Number]"==Qs.call(t)};var ta=Function.prototype,ra=Object.prototype,na=ta.toString,ia=ra.hasOwnProperty,oa=na.call(Object),sa=ra.toString,aa=function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object);var ua=function(t){if(!function(t){return!!t&&"object"==e(t)}(t)||"[object Object]"!=sa.call(t)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(t))return!1;var r=aa(t);if(null===r)return!0;var n=ia.call(r,"constructor")&&r.constructor;return"function"==typeof n&&n instanceof n&&na.call(n)==oa},ca=Object.prototype.toString,fa=Array.isArray;var la=function(t){return"string"==typeof t||!fa(t)&&function(t){return!!t&&"object"==e(t)}(t)&&"[object String]"==ca.call(t)},ha=1/0,pa=17976931348623157e292,da=NaN,va="[object Symbol]",ya=/^\s+|\s+$/g,ga=/^[-+]0x[0-9a-f]+$/i,ma=/^0b[01]+$/i,ba=/^0o[0-7]+$/i,wa=parseInt,ka=Object.prototype.toString;function Sa(t,r){var n;if("function"!=typeof r)throw new TypeError("Expected a function");return t=function(t){var r=function(t){if(!t)return 0===t?t:0;if(t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==e(t)||function(t){return!!t&&"object"==e(t)}(t)&&ka.call(t)==va}(t))return da;if(Ea(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=Ea(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ya,"");var n=ma.test(t);return n||ba.test(t)?wa(t.slice(2),n?2:8):ga.test(t)?da:+t}(t),t===ha||t===-1/0){return(t<0?-1:1)*pa}return t==t?t:0}(t),n=r%1;return r==r?n?r-n:r:0}(t),function(){return--t>0&&(n=r.apply(this,arguments)),t<=1&&(r=void 0),n}}function Ea(t){var r=e(t);return!!t&&("object"==r||"function"==r)}var _a=function(e){return Sa(2,e)},Ca=Ko,Ra=gt,Aa=Fs,Ta=Us,xa=Zs,ja=ea,Oa=ua,Pa=la,Ba=_a,Na=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];Go&&Na.splice(3,0,"PS256","PS384","PS512");var Ma={expiresIn:{isValid:function(e){return xa(e)||Pa(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return xa(e)||Pa(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return Pa(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:Aa.bind(null,Na),message:'"algorithm" must be a valid string enum value'},header:{isValid:Oa,message:'"header" must be an object'},encoding:{isValid:Pa,message:'"encoding" must be a string'},issuer:{isValid:Pa,message:'"issuer" must be a string'},subject:{isValid:Pa,message:'"subject" must be a string'},jwtid:{isValid:Pa,message:'"jwtid" must be a string'},noTimestamp:{isValid:Ta,message:'"noTimestamp" must be a boolean'},keyid:{isValid:Pa,message:'"keyid" must be a string'},mutatePayload:{isValid:Ta,message:'"mutatePayload" must be a boolean'}},La={iat:{isValid:ja,message:'"iat" should be a number of seconds'},exp:{isValid:ja,message:'"exp" should be a number of seconds'},nbf:{isValid:ja,message:'"nbf" should be a number of seconds'}};function Ia(e,t,r,n){if(!Oa(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach((function(i){var o=e[i];if(o){if(!o.isValid(r[i]))throw new Error(o.message)}else if(!t)throw new Error('"'+i+'" is not allowed in "'+n+'"')}))}var Fa={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},Da=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"],Ua=function(e,t,r,n){var i;if("function"!=typeof r||n||(n=r,r={}),r||(r={}),r=Object.assign({},r),i=n||function(e,t){if(e)throw e;return t},r.clockTimestamp&&"number"!=typeof r.clockTimestamp)return i(new Xo("clockTimestamp must be a number"));if(void 0!==r.nonce&&("string"!=typeof r.nonce||""===r.nonce.trim()))return i(new Xo("nonce must be a non-empty string"));var o=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return i(new Xo("jwt must be provided"));if("string"!=typeof e)return i(new Xo("jwt must be a string"));var s,a=e.split(".");if(3!==a.length)return i(new Xo("jwt malformed"));try{s=es(e,{complete:!0})}catch(e){return i(e)}if(!s)return i(new Xo("invalid token"));var u,c=s.header;if("function"==typeof t){if(!n)return i(new Xo("verify must be called asynchronous if secret or public key is provided as a callback"));u=t}else u=function(e,r){return r(null,t)};return u(c,(function(t,n){if(t)return i(new Xo("error in secret or public key callback: "+t.message));var u,f=""!==a[2].trim();if(!f&&n)return i(new Xo("jwt signature is required"));if(f&&!n)return i(new Xo("secret or public key must be provided"));if(f||r.algorithms||(r.algorithms=["none"]),r.algorithms||(r.algorithms=~n.toString().indexOf("BEGIN CERTIFICATE")||~n.toString().indexOf("BEGIN PUBLIC KEY")?ns:~n.toString().indexOf("BEGIN RSA PUBLIC KEY")?is:os),!~r.algorithms.indexOf(s.header.alg))return i(new Xo("invalid algorithm"));try{u=rs.verify(e,s.header.alg,n)}catch(e){return i(e)}if(!u)return i(new Xo("invalid signature"));var l=s.payload;if(void 0!==l.nbf&&!r.ignoreNotBefore){if("number"!=typeof l.nbf)return i(new Xo("invalid nbf value"));if(l.nbf>o+(r.clockTolerance||0))return i(new Zo("jwt not active",new Date(1e3*l.nbf)))}if(void 0!==l.exp&&!r.ignoreExpiration){if("number"!=typeof l.exp)return i(new Xo("invalid exp value"));if(o>=l.exp+(r.clockTolerance||0))return i(new Qo("jwt expired",new Date(1e3*l.exp)))}if(r.audience){var h=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(l.aud)?l.aud:[l.aud]).some((function(e){return h.some((function(t){return t instanceof RegExp?t.test(e):t===e}))})))return i(new Xo("jwt audience invalid. expected: "+h.join(" or ")))}if(r.issuer&&("string"==typeof r.issuer&&l.iss!==r.issuer||Array.isArray(r.issuer)&&-1===r.issuer.indexOf(l.iss)))return i(new Xo("jwt issuer invalid. expected: "+r.issuer));if(r.subject&&l.sub!==r.subject)return i(new Xo("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&l.jti!==r.jwtid)return i(new Xo("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&l.nonce!==r.nonce)return i(new Xo("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if("number"!=typeof l.iat)return i(new Xo("iat required when maxAge is specified"));var p=ts(r.maxAge,l.iat);if(void 0===p)return i(new Xo('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(o>=p+(r.clockTolerance||0))return i(new Qo("maxAge exceeded",new Date(1e3*p)))}if(!0===r.complete){var d=s.signature;return i(null,{header:c,payload:l,signature:d})}return i(null,l)}))},qa=function(t,r,n,i){"function"==typeof n?(i=n,n={}):n=n||{};var o="object"===e(t)&&!Buffer.isBuffer(t),s=Object.assign({alg:n.algorithm||"HS256",typ:o?"JWT":void 0,kid:n.keyid},n.header);function a(e){if(i)return i(e);throw e}if(!r&&"none"!==n.algorithm)return a(new Error("secretOrPrivateKey must have a value"));if(void 0===t)return a(new Error("payload is required"));if(o){try{!function(e){Ia(La,!0,e,"payload")}(t)}catch(e){return a(e)}n.mutatePayload||(t=Object.assign({},t))}else{var u=Da.filter((function(e){return void 0!==n[e]}));if(u.length>0)return a(new Error("invalid "+u.join(",")+" option for "+e(t)+" payload"))}if(void 0!==t.exp&&void 0!==n.expiresIn)return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==t.nbf&&void 0!==n.notBefore)return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){Ia(Ma,!1,e,"options")}(n)}catch(e){return a(e)}var c=t.iat||Math.floor(Date.now()/1e3);if(n.noTimestamp?delete t.iat:o&&(t.iat=c),void 0!==n.notBefore){try{t.nbf=Ca(n.notBefore,c)}catch(e){return a(e)}if(void 0===t.nbf)return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==n.expiresIn&&"object"===e(t)){try{t.exp=Ca(n.expiresIn,c)}catch(e){return a(e)}if(void 0===t.exp)return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(Fa).forEach((function(e){var r=Fa[e];if(void 0!==n[e]){if(void 0!==t[r])return a(new Error('Bad "options.'+e+'" option. The payload already has an "'+r+'" property.'));t[r]=n[e]}}));var f=n.encoding||"utf8";if("function"!=typeof i)return Ra.sign({header:s,payload:t,secret:r,encoding:f});i=i&&Ba(i),Ra.createSign({header:s,privateKey:r,payload:t,encoding:f}).once("error",i).once("done",(function(e){i(null,e)}))},Ya=et("Socket"),Va=et("Peer"),za=et("Remote"),$a=function(e){function t(t){var r=t.secret,n=t.room,i=t.hasVideo,o=t.hasAudio,s=e.call(this)||this;return s.handleMessage=function(e){var t=e.type,r=e.from,n=e.to,i=e.room,o=e.token;return y(s,void 0,void 0,(function(){var e=this;return g(this,(function(s){return Ua(o,this.secret,(function(o,s){return y(e,void 0,void 0,(function(){var e,a;return g(this,(function(u){switch(u.label){case 0:if(o&&Ya("Token Decoding Error",o),!s)return[3,9];switch(t){case"peer-connection-request":return[3,1];case"data":return[3,2];case"track-update":return[3,3];case"socket-update":return[3,4];case"error":return[3,5];case"ping":return[3,6]}return[3,8];case 1:return this.onPeerConnectRequest({from:r,to:n,data:s}),[3,9];case 2:return this.handlePeerData({from:r,to:n,data:s}),[3,9];case 3:return this.handleTrackUpdate(s),[3,9];case 4:return this.handleSocketUpdate(s),[3,9];case 5:return e=s.error,Ya("Socket Server Error",e),this.emit("error",e),[3,9];case 6:return Ya("PING from socket server."),[4,this.getStats()];case 7:return a=u.sent(),this.sendMessage("PONG",{data:a}),[3,9];case 8:return Ya("Unknown Event Type",{type:t,from:r,to:n,room:i,data:s}),[3,9];case 9:return[2]}}))}))})),[2]}))}))},s.onPeerConnectRequest=function(e){var t=e.from,r=e.to,n=e.data,i=n.response,o=n.peerName;i&&s.sendMessage("connection-request",{from:r,to:t,data:{response:!1,peerName:s.name}}),Ya("New Peer Connected. Waiting for an offer"),s.peers.set(o,new RTCPeerConnection({iceServers:s.iceServers}));var a=s.peers.get(o);za("Adding Tracks",s.streams),s.streams.getTracks().forEach((function(e){a.addTrack(e,s.streams)})),za("Tracks Added"),a.ontrack=function(e){var t=e.currentTarget.to;s.remoteStreams.set(t.name,e.streams),s.emit("new-remote-track",e)},a.onicecandidate=function(e){if(e.candidate){za("ICE Candidate",e);var t=e.currentTarget;s.sendMessage("data",{from:t.from.socket,to:t.to.socket,data:{name:a.from.name,candidate:e.candidate}})}},a.onnegotiationneeded=function(e){return y(s,void 0,void 0,(function(){var t,r,n;return g(this,(function(i){switch(i.label){case 0:t=e.currentTarget,i.label=1;case 1:return i.trys.push([1,4,5,6]),t.makingOffer=!0,za("Negotiation needed",e),[4,t.createOffer()];case 2:return r=i.sent(),za("Offer Generated",r),"stable"!=t.signalingState?[2]:[4,t.setLocalDescription(r)];case 3:return i.sent(),za("Local Description Set",t.localDescription),this.sendMessage("data",{to:t.to.socket,from:t.from.socket,data:{name:t.from.name,sdp:t.localDescription}}),[3,6];case 4:return n=i.sent(),console.error(new Error(n)),[3,6];case 5:return t.makingOffer=!1,[7];case 6:return[2]}}))}))},a.onconnectionstatechange=function(e){switch(a.connectionState){case"new":case"connecting":za("Connecting...");break;case"connected":za("Connected."),s.emit("new-peer",a),a.checkConnection();break;case"disconnected":za("Disconnecting..."),a.checkConnection();break;case"closed":za("Offline");break;case"failed":za("Error"),a.checkConnection()}},a.checkConnection=function(){var e=a.connectionState,t=a.iceConnectionState,r=a.iceGatheringState,n=a.signalingState;"connected"===e&&"connected"===t&&"complete"===r&&"stable"===n?za("Connection Established."):"disconnected"!==e&&"closed"!==e&&"failed"!==e||"disconnected"!==t&&"failed"!==t&&"closed"!==t||(za("Error in Connection Establishment"),s.emit("peer-left",a.to.name),s.removePeer(a.to.name))},a.from={name:s.name,socket:s.socket.id},a.to={name:o,socket:t},a.initiator=i,a.ignoreOffer=!1,a.makingOffer=!1,a.socket=s.socket,a.poster=s.createPoster(o)},s.handlePeerData=function(e){var t=e.to,r=e.from,n=e.data;return y(s,void 0,void 0,(function(){var e,i,o,s,a,u,c,f;return g(this,(function(l){switch(l.label){case 0:if(e=n.name,i=n.sdp,o=n.candidate,!this.peers.has(e)||t!==this.socket.id)return[3,15];l.label=1;case 1:return l.trys.push([1,14,,15]),s=this.peers.get(e),Va("Data recieved",{name:e,sdp:i,candidate:o}),i?(a="offer"===i.type&&(s.makingOffer||"stable"!==s.signalingState),s.ignoreOffer=!s.initiator&&a,s.ignoreOffer?[2]:a?[4,Promise.all([s.setLocalDescription({type:"rollback"}),s.setRemoteDescription(i)])]:[3,3]):[3,9];case 2:return l.sent(),[3,5];case 3:return Va("Answer Recieved",i),[4,s.setRemoteDescription(i)];case 4:l.sent(),l.label=5;case 5:return"offer"!==i.type?[3,8]:[4,s.createAnswer()];case 6:return u=l.sent(),Va("Answer Created",u),[4,s.setLocalDescription(u)];case 7:l.sent(),Va("Local description set as answer",s.localDescription),this.sendMessage("data",{to:r,from:t,data:{name:this.name,sdp:s.localDescription}}),l.label=8;case 8:return[3,13];case 9:if(!o)return[3,13];l.label=10;case 10:return l.trys.push([10,12,,13]),[4,s.addIceCandidate(o)];case 11:return l.sent(),Va("Added Ice Candidate",o),[3,13];case 12:return c=l.sent(),s.ignoreOffer?Va("Should be ignored",c,o,this.peers.has(e),t===this.socket.id):Va("Error adding IceCandidate",c),[3,13];case 13:return[3,15];case 14:return f=l.sent(),Ya("Socket Error",f),[3,15];case 15:return[2]}}))}))},s.handleTrackUpdate=function(e){var t=e.id,r=e.update;switch(Ya("Track Update Recieved",t,r),r){case"mute":s.emit("remote-peer-track-muted",t);break;case"unmute":s.emit("remote-peer-track-unmuted",t);break;case"end":s.remoteStreams.get(t).forEach((function(e){return e.getVideoTracks()[0].stop()})),s.emit("remote-peer-track-ended",t)}},s.handleSocketUpdate=function(e){var t=e.id,r=e.name;s.peers.get(r).to.socket=t,Ya("Socket ID updated for peer.")},s.getStats=function(){return new Promise((function(e,t){return y(s,void 0,void 0,(function(){var t,r,n,i,o,s,a,u,c,f,l;return g(this,(function(h){switch(h.label){case 0:t={},h.label=1;case 1:h.trys.push([1,6,7,8]),r=m(this.peers),n=r.next(),h.label=2;case 2:return n.done?[3,5]:(i=b(n.value,2),o=i[0],s=i[1],a=t,u=o,[4,s.getStats(null)]);case 3:a[u]=h.sent(),h.label=4;case 4:return n=r.next(),[3,2];case 5:return[3,8];case 6:return c=h.sent(),f={error:c},[3,8];case 7:try{n&&!n.done&&(l=r.return)&&l.call(r)}finally{if(f)throw f.error}return[7];case 8:return e(t),[2]}}))}))}))},s.sendMessage=function(e,t,r){var n=t.from,i=t.to,o=t.room,a=t.data,u=qa({data:a},s.secret);s.socket.emit("message",{type:e,from:n,to:i,room:o,token:u},r)},s.join=function(){return y(s,void 0,void 0,(function(){var e=this;return g(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){Ya("Joining Room"),e.sendMessage("room-join",{room:e.room,data:{name:e.name}},(function(r){var n=r.res,i=r.error;i?(e.emit("error",i),Ya("Room Join Error",i)):n&&(Ya("Room Joined",n),n.length>1&&(Ya("Peers List Recieved"),n.forEach((function(t){t!==e.socket.id&&e.sendMessage("connection-request",{from:e.socket.id,to:t,data:{response:!0,peerName:e.name}})})),Va("Establishing Peer Connection to Remote Peer."),t()))}))}))];case 1:return t.sent(),[2]}}))}))},s.startMedia=function(e){return y(s,void 0,void 0,(function(){var t;return g(this,(function(r){switch(r.label){case 0:return[4,this.getMedia()];case 1:return t=r.sent(),this.addStream(t),e?this.streams=t:(this.streams=t,this.replaceMedia(t)),[2]}}))}))},s.getMedia=function(){return new Promise((function(e,t){navigator.mediaDevices.getUserMedia({video:s.media.video,audio:s.media.audio}).then((function(t){Va(t),e(t)})).catch(t)}))},s.screenShare=function(){return navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(e){var t=e.getVideoTracks()[0];Va("Sharing Screen",t),t.onended=function(e){return y(s,void 0,void 0,(function(){return g(this,(function(t){return Va("Stop Sharing Screen"),this.emit("screen-share-ended",e),this.replaceMedia(this.streams),this.addStream(this.streams),[2]}))}))},s.replaceMedia(e),s.addStream(e)})).catch(console.error)},s.addStream=function(e){var t=document.querySelector(".self");t.srcObject=e,t.onloadedmetadata=function(e){t.play()}},s.toggleMedia=function(e,t){if(e)switch(e){case"video":s.streams.getVideoTracks().forEach((function(e){e.enabled=!e.enabled}));break;case"audio":s.streams.getAudioTracks().forEach((function(e){e.enabled=!e.enabled}));break;case"all":s.streams.getTracks().forEach((function(e){e.enabled=!e.enabled}))}t&&s.peers.get(t).getSenders().forEach((function(t){var r,n;e?(null===(r=null==t?void 0:t.track)||void 0===r?void 0:r.kind)===e&&t.track.stop():null===(n=null==t?void 0:t.track)||void 0===n||n.stop()}))},s.createPoster=function(e){var t=document.createElement("canvas");t.id="canv",t.height=600,t.width=800,document.body.appendChild(t);var r=document.getElementById("canv").getContext("2d");r.fillStyle="#1C1917",r.fillRect(0,0,800,600),r.fillStyle="#FAFAF9",r.textAlign="center",r.font="64px sans-serif",r.fillText(e,400,300);var n=t.toDataURL();return document.body.removeChild(t),n},s.getLocalMedia=function(e){return s.peers.get(e).getLocalStream()},s.getRemoteStream=function(e){return s.peers.get(e).getRemoteStream()},s.replaceMediaTrack=function(e,t){var r,n;if(t)s.peers.get(t).getSenders().forEach((function(t){var r;(null===(r=null==t?void 0:t.track)||void 0===r?void 0:r.kind)===e.kind&&(e.enabled=!0,t.replaceTrack(e))}));else try{for(var i=m(s.peers),o=i.next();!o.done;o=i.next()){var a=b(o.value,2);a[0];a[1].getSenders().forEach((function(t){var r;(null===(r=null==t?void 0:t.track)||void 0===r?void 0:r.kind)===e.kind&&t.replaceTrack(e)}))}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},s.replaceMedia=function(e,t){return new Promise((function(r,n){var i,o,a,u,c,f;try{if(t)try{for(var l=m(e.getTracks()),h=l.next();!h.done;h=l.next()){var p=h.value;t?s.replaceMediaTrack(p,t):s.replaceMediaTrack(p),Va("Replacing Track",p,t)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}else try{for(var d=m(s.peers),v=d.next();!v.done;v=d.next()){var y=b(v.value,2),g=y[0];if(y[1].getSenders().length>0)try{for(var w=(c=void 0,m(e.getTracks())),k=w.next();!k.done;k=w.next()){p=k.value;s.replaceMediaTrack(p,g),Va("Replacing Track",p,g)}}catch(e){c={error:e}}finally{try{k&&!k.done&&(f=w.return)&&f.call(w)}finally{if(c)throw c.error}}}}catch(e){a={error:e}}finally{try{v&&!v.done&&(u=d.return)&&u.call(d)}finally{if(a)throw a.error}}r(!0)}catch(e){n(e)}}))},s.removePeer=function(e){s.peers.get(e).close(),za("Remote Peer Connection Closed"),s.peers.delete(e),za("Remote Peer Removed"),s.remoteStreams.delete(e),za("Remote Peer Stream Removed")},s.close=function(){var e,t;try{for(var r=m(s.peers),n=r.next();!n.done;n=r.next()){var i=b(n.value,2),o=i[0];i[1];s.removePeer(o)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},s.addMediaTrack=function(e,t){var r,n;if(s.streams.addTrack(e),t)s.peers.get(t).addTrack(e);else if(s.peers.size>0)try{for(var i=m(s.peers),o=i.next();!o.done;o=i.next()){var a=b(o.value,2);a[0];a[1].addTrack(e)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},s.addMedia=function(e,t){e.getTracks().forEach((function(e){return t?s.addMediaTrack(e,t):s.addMediaTrack(e)})),Va("Added new Stream",s.peers)},s.removeMediaTrack=function(e){var t,r,n=function(t,r){r.getSenders().forEach((function(t){var n;(null===(n=null==t?void 0:t.track)||void 0===n?void 0:n.kind)===e.kind&&(r.removeTrack(t),Ya("Track Update Request Sent."),s.sendMessage("track-update",{room:s.room,data:{id:r.from.name,update:"end"}}))}))};try{for(var i=m(s.peers),o=i.next();!o.done;o=i.next()){var a=b(o.value,2);a[0];n(0,a[1])}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}s.streams.removeTrack(e)},s.removeMedia=function(e){e.getTracks().forEach((function(e){return s.removeMediaTrack(e)})),Va("Removed Stream",e)},s.secret=r,s.hasAudio=o||!0,s.hasVideo=i||!0,s.media={video:s.hasVideo,audio:s.hasAudio},s.streams=new MediaStream,s.startMedia(!0),s.name=btoa(Math.random().toString()).substring(10,5),s.poster=s.createPoster(s.name),s.room=n,s.buffer=50,s.remoteStreams=new Map,s.peers=new Map,s.iceServers=[],s.id=btoa(Math.random().toString()).substring(16,4).split("").map((function(e){return"-_0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[~~(64*Math.random())]})).join(""),s.socket=De("https://p2p.6buns.com",{transports:["websocket","polling"],auth:{key:s.secret}}),s.socket.on("connection",(function(e,t,r){Ya("Socket Connected",{id:e,users:t,iceServers:r}),s.iceServers=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}([],b(r),!1),s.peers.size>0?s.sendMessage("update-socket-id",{room:s.room,data:{id:s.socket.id,name:s.name}}):s.join()})),s.socket.on("message",(function(e){var t=e.type,r=e.from,n=e.to,i=e.room,o=e.token;return s.handleMessage({type:t,from:r,to:n,room:i,token:o})})),s.socket.on("peer-disconnected",(function(e){Ya("Socket Disconnected",e),s.removePeer(e)})),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t}(tt.exports.EventEmitter);return $a}();
