var Bun=function(){"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function p(e,t,r){return p=h()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&l(o,r.prototype),o},p.apply(null,arguments)}function d(e){var t="function"==typeof Map?new Map:void 0;return d=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return p(e,arguments,f(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,e)},d(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function m(e){var t=h();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function g(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=g(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},b.apply(this,arguments)}function w(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(e,t):void 0}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=k(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var S=function(e,t){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},S(e,t)};function _(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function A(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function x(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function T(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}var O=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,R=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],P=function(e){var t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));for(var o,i,a=O.exec(e||""),s={},c=14;c--;)s[R[c]]=a[c]||"";return-1!=r&&-1!=n&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){var r=/\/{2,9}/g,n=t.replace(r,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||n.splice(0,1);"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1);return n}(0,s.path),s.queryKey=(o=s.query,i={},o.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(i[t]=r)})),i),s};var L={exports:{}};try{L.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){L.exports=!1}var j=L.exports,N="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function F(e){var t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||j))return new XMLHttpRequest}catch(e){}if(!t)try{return new(N[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function M(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((function(t,r){return e.hasOwnProperty(r)&&(t[r]=e[r]),t}),{})}var D=setTimeout,I=clearTimeout;function H(e,t){t.useNativeTimers?(e.setTimeoutFn=D.bind(N),e.clearTimeoutFn=I.bind(N)):(e.setTimeoutFn=setTimeout.bind(N),e.clearTimeoutFn=clearTimeout.bind(N))}var B=U;function U(e){if(e)return function(e){for(var t in U.prototype)e[t]=U.prototype[t];return e}(e)}U.prototype.on=U.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},U.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},U.prototype.off=U.prototype.removeListener=U.prototype.removeAllListeners=U.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},U.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,t)}return this},U.prototype.emitReserved=U.prototype.emit,U.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},U.prototype.hasListeners=function(e){return!!this.listeners(e).length};var J=Object.create(null);J.open="0",J.close="1",J.ping="2",J.pong="3",J.message="4",J.upgrade="5",J.noop="6";var W=Object.create(null);Object.keys(J).forEach((function(e){W[J[e]]=e}));for(var q={type:"error",data:"parser error"},V="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),K="function"==typeof ArrayBuffer,z=function(e,t,r){var n,o=e.type,i=e.data;return V&&i instanceof Blob?t?r(i):G(i,r):K&&(i instanceof ArrayBuffer||(n=i,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer))?t?r(i):G(new Blob([i]),r):r(J[o]+(i||""))},G=function(e,t){var r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];t("b"+e)},r.readAsDataURL(e)},Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$="undefined"==typeof Uint8Array?[]:new Uint8Array(256),X=0;X<Y.length;X++)$[Y.charCodeAt(X)]=X;var Z,Q="function"==typeof ArrayBuffer,ee=function(e,t){if("string"!=typeof e)return{type:"message",data:re(e,t)};var r=e.charAt(0);return"b"===r?{type:"message",data:te(e.substring(1),t)}:W[r]?e.length>1?{type:W[r],data:e.substring(1)}:{type:W[r]}:q},te=function(e,t){if(Q){var r=function(e){var t,r,n,o,i,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),f=new Uint8Array(u);for(t=0;t<s;t+=4)r=$[e.charCodeAt(t)],n=$[e.charCodeAt(t+1)],o=$[e.charCodeAt(t+2)],i=$[e.charCodeAt(t+3)],f[c++]=r<<2|n>>4,f[c++]=(15&n)<<4|o>>2,f[c++]=(3&o)<<6|63&i;return u}(e);return re(r,t)}return{base64:!0,data:e}},re=function(e,t){return"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e},ne=String.fromCharCode(30),oe=function(e){u(r,e);var t=m(r);function r(e){var n;return i(this,r),(n=t.call(this)).writable=!1,H(y(n),e),n.opts=e,n.query=e.query,n.readyState="",n.socket=e.socket,n}return s(r,[{key:"onError",value:function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,b(f(r.prototype),"emit",this).call(this,"error",n),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,b(f(r.prototype),"emit",this).call(this,"open")}},{key:"onData",value:function(e){var t=ee(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){b(f(r.prototype),"emit",this).call(this,"packet",e)}},{key:"onClose",value:function(){this.readyState="closed",b(f(r.prototype),"emit",this).call(this,"close")}}]),r}(B),ie="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),ae={},se=0,ce=0;function ue(e){var t="";do{t=ie[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function fe(){var e=ue(+new Date);return e!==Z?(se=0,Z=e):e+"."+ue(se++)}for(;ce<64;ce++)ae[ie[ce]]=ce;fe.encode=ue,fe.decode=function(e){var t=0;for(ce=0;ce<e.length;ce++)t=64*t+ae[e.charAt(ce)];return t};var le=fe,he={encode:function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},decode:function(e){for(var t={},r=e.split("&"),n=0,o=r.length;n<o;n++){var i=r[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},pe=function(e){u(r,e);var t=m(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).polling=!1,e}return s(r,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var r=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var n=0;this.polling&&(n++,this.once("pollComplete",(function(){--n||r()}))),this.writable||(n++,this.once("drain",(function(){--n||r()})))}else r()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emit("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var r=e.split(ne),n=[],o=0;o<r.length;o++){var i=ee(r[o],t);if(n.push(i),"error"===i.type)break}return n})(e,this.socket.binaryType).forEach((function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,t){var r=e.length,n=new Array(r),o=0;e.forEach((function(e,i){z(e,!1,(function(e){n[i]=e,++o===r&&t(n.join(ne))}))}))}(e,(function(e){t.doWrite(e,(function(){t.writable=!0,t.emit("drain")}))}))}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"https":"http",r="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=le()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port);var n=he.encode(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}}]),r}(oe);function de(){}var ye=null!=new F({xdomain:!1}).responseType,ve=function(e){u(r,e);var t=m(r);function r(e){var n;if(i(this,r),n=t.call(this,e),"undefined"!=typeof location){var o="https:"===location.protocol,a=location.port;a||(a=o?"443":"80"),n.xd="undefined"!=typeof location&&e.hostname!==location.hostname||a!==e.port,n.xs=e.secure!==o}var s=e&&e.forceBase64;return n.supportsBinary=ye&&!s,n}return s(r,[{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new me(this.uri(),e)}},{key:"doWrite",value:function(e,t){var r=this,n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(function(e){r.onError("xhr post error",e)}))}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t}}]),r}(pe),me=function(e){u(r,e);var t=m(r);function r(e,n){var o;return i(this,r),H(y(o=t.call(this)),n),o.opts=n,o.method=n.method||"GET",o.uri=e,o.async=!1!==n.async,o.data=void 0!==n.data?n.data:null,o.create(),o}return s(r,[{key:"create",value:function(){var e=this,t=M(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var n=this.xhr=new F(t);try{n.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var o in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this.opts.extraHeaders[o])}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=function(){4===n.readyState&&(200===n.status||1223===n.status?e.onLoad():e.setTimeoutFn((function(){e.onError("number"==typeof n.status?n.status:0)}),0))},n.send(this.data)}catch(t){return void this.setTimeoutFn((function(){e.onError(t)}),0)}"undefined"!=typeof document&&(this.index=r.requestsCount++,r.requests[this.index]=this)}},{key:"onSuccess",value:function(){this.emit("success"),this.cleanup()}},{key:"onData",value:function(e){this.emit("data",e),this.onSuccess()}},{key:"onError",value:function(e){this.emit("error",e),this.cleanup(!0)}},{key:"cleanup",value:function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=de,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete r.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&this.onData(e)}},{key:"abort",value:function(){this.cleanup()}}]),r}(B);if(me.requestsCount=0,me.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",ge);else if("function"==typeof addEventListener){addEventListener("onpagehide"in N?"pagehide":"unload",ge,!1)}function ge(){for(var e in me.requests)me.requests.hasOwnProperty(e)&&me.requests[e].abort()}var be="function"==typeof Promise&&"function"==typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},we=N.WebSocket||N.MozWebSocket,ke="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),Ee=function(e){u(r,e);var t=m(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).supportsBinary=!e.forceBase64,n}return s(r,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,r=ke?{}:M(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=ke?new we(e,t,r):t?new we(e,t):new we(e)}catch(e){return this.emit("error",e)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var r=function(r){var n=e[r],o=r===e.length-1;z(n,t.supportsBinary,(function(e){try{t.ws.send(e)}catch(e){}o&&be((function(){t.writable=!0,t.emit("drain")}),t.setTimeoutFn)}))},n=0;n<e.length;n++)r(n)}},{key:"doClose",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"wss":"ws",r="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=le()),this.supportsBinary||(e.b64=1);var n=he.encode(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}},{key:"check",value:function(){return!(!we||"__initialize"in we&&this.name===r.prototype.name)}}]),r}(oe),Ce={websocket:Ee,polling:ve},Se=function(e){u(n,e);var t=m(n);function n(e){var o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i(this,n),o=t.call(this),e&&"object"===r(e)&&(a=e,e=null),e?(e=P(e),a.hostname=e.host,a.secure="https"===e.protocol||"wss"===e.protocol,a.port=e.port,e.query&&(a.query=e.query)):a.host&&(a.hostname=P(a.host).host),H(y(o),a),o.secure=null!=a.secure?a.secure:"undefined"!=typeof location&&"https:"===location.protocol,a.hostname&&!a.port&&(a.port=o.secure?"443":"80"),o.hostname=a.hostname||("undefined"!=typeof location?location.hostname:"localhost"),o.port=a.port||("undefined"!=typeof location&&location.port?location.port:o.secure?"443":"80"),o.transports=a.transports||["polling","websocket"],o.readyState="",o.writeBuffer=[],o.prevBufferLen=0,o.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},a),o.opts.path=o.opts.path.replace(/\/$/,"")+"/","string"==typeof o.opts.query&&(o.opts.query=he.decode(o.opts.query)),o.id=null,o.upgrades=null,o.pingInterval=null,o.pingTimeout=null,o.pingTimeoutTimer=null,"function"==typeof addEventListener&&(o.opts.closeOnBeforeunload&&addEventListener("beforeunload",(function(){o.transport&&(o.transport.removeAllListeners(),o.transport.close())}),!1),"localhost"!==o.hostname&&(o.offlineEventListener=function(){o.onClose("transport close")},addEventListener("offline",o.offlineEventListener,!1))),o.open(),o}return s(n,[{key:"createTransport",value:function(e){var t=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Ce[e](r)}},{key:"open",value:function(){var e,t=this;if(this.opts.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((function(){t.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(function(){t.onClose("transport close")}))}},{key:"probe",value:function(e){var t=this,r=this.createTransport(e),o=!1;n.priorWebsocketSuccess=!1;var i=function(){o||(r.send([{type:"ping",data:"probe"}]),r.once("packet",(function(e){if(!o)if("pong"===e.type&&"probe"===e.data){if(t.upgrading=!0,t.emitReserved("upgrading",r),!r)return;n.priorWebsocketSuccess="websocket"===r.name,t.transport.pause((function(){o||"closed"!==t.readyState&&(l(),t.setTransport(r),r.send([{type:"upgrade"}]),t.emitReserved("upgrade",r),r=null,t.upgrading=!1,t.flush())}))}else{var i=new Error("probe error");i.transport=r.name,t.emitReserved("upgradeError",i)}})))};function a(){o||(o=!0,l(),r.close(),r=null)}var s=function(e){var n=new Error("probe error: "+e);n.transport=r.name,a(),t.emitReserved("upgradeError",n)};function c(){s("transport closed")}function u(){s("socket closed")}function f(e){r&&e.name!==r.name&&a()}var l=function(){r.removeListener("open",i),r.removeListener("error",s),r.removeListener("close",c),t.off("close",u),t.off("upgrading",f)};r.once("open",i),r.once("error",s),r.once("close",c),this.once("close",u),this.once("upgrading",f),r.open()}},{key:"onOpen",value:function(){if(this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((function(){e.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}},{key:"write",value:function(e,t,r){return this.sendPacket("message",e,t,r),this}},{key:"send",value:function(e,t,r){return this.sendPacket("message",e,t,r),this}},{key:"sendPacket",value:function(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var o={type:e,data:t,options:r};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}}},{key:"close",value:function(){var e=this,t=function(){e.onClose("forced close"),e.transport.close()},r=function r(){e.off("upgrade",r),e.off("upgradeError",r),t()},n=function(){e.once("upgrade",r),e.once("upgradeError",r)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){e.upgrading?n():t()})):this.upgrading?n():t()),this}},{key:"onError",value:function(e){n.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],r=0,n=e.length;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}]),n}(B);Se.protocol=4;var _e="function"==typeof ArrayBuffer,Ae=Object.prototype.toString,xe="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Ae.call(Blob),Te="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Ae.call(File);function Oe(e){return _e&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))||xe&&e instanceof Blob||Te&&e instanceof File}function Re(e,t){if(!e||"object"!==r(e))return!1;if(Array.isArray(e)){for(var n=0,o=e.length;n<o;n++)if(Re(e[n]))return!0;return!1}if(Oe(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return Re(e.toJSON(),!0);for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&Re(e[i]))return!0;return!1}function Pe(e){var t=[],r=e.data,n=e;return n.data=Le(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Le(e,t){if(!e)return e;if(Oe(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){for(var o=new Array(e.length),i=0;i<e.length;i++)o[i]=Le(e[i],t);return o}if("object"===r(e)&&!(e instanceof Date)){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(a[s]=Le(e[s],t));return a}return e}function je(e,t){return e.data=Ne(e.data,t),e.attachments=void 0,e}function Ne(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=Ne(e[n],t);else if("object"===r(e))for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(e[o]=Ne(e[o],t));return e}var Fe;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Fe||(Fe={}));var Me=function(){function e(){i(this,e)}return s(e,[{key:"encode",value:function(e){return e.type!==Fe.EVENT&&e.type!==Fe.ACK||!Re(e)?[this.encodeAsString(e)]:(e.type=e.type===Fe.EVENT?Fe.BINARY_EVENT:Fe.BINARY_ACK,this.encodeAsBinary(e))}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==Fe.BINARY_EVENT&&e.type!==Fe.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data)),t}},{key:"encodeAsBinary",value:function(e){var t=Pe(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}]),e}(),De=function(e){u(n,e);var t=m(n);function n(){return i(this,n),t.call(this)}return s(n,[{key:"add",value:function(e){var t;if("string"==typeof e)(t=this.decodeString(e)).type===Fe.BINARY_EVENT||t.type===Fe.BINARY_ACK?(this.reconstructor=new Ie(t),0===t.attachments&&b(f(n.prototype),"emitReserved",this).call(this,"decoded",t)):b(f(n.prototype),"emitReserved",this).call(this,"decoded",t);else{if(!Oe(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,b(f(n.prototype),"emitReserved",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,r={type:Number(e.charAt(0))};if(void 0===Fe[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Fe.BINARY_EVENT||r.type===Fe.BINARY_ACK){for(var o=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var i=e.substring(o,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){for(var a=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(a,t)}else r.nsp="/";var s=e.charAt(t+1);if(""!==s&&Number(s)==s){for(var c=t+1;++t;){var u=e.charAt(t);if(null==u||Number(u)!=u){--t;break}if(t===e.length)break}r.id=Number(e.substring(c,t+1))}if(e.charAt(++t)){var f=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!n.isPayloadValid(r.type,f))throw new Error("invalid payload");r.data=f}return r}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(e,t){switch(e){case Fe.CONNECT:return"object"===r(t);case Fe.DISCONNECT:return void 0===t;case Fe.CONNECT_ERROR:return"string"==typeof t||"object"===r(t);case Fe.EVENT:case Fe.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Fe.ACK:case Fe.BINARY_ACK:return Array.isArray(t)}}}]),n}(B);var Ie=function(){function e(t){i(this,e),this.packet=t,this.buffers=[],this.reconPack=t}return s(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=je(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}(),He=Object.freeze({__proto__:null,protocol:5,get PacketType(){return Fe},Encoder:Me,Decoder:De});function Be(e,t,r){return e.on(t,r),function(){e.off(t,r)}}var Ue=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Je=function(e){u(r,e);var t=m(r);function r(e,n,o){var a;return i(this,r),(a=t.call(this)).connected=!1,a.disconnected=!0,a.receiveBuffer=[],a.sendBuffer=[],a.ids=0,a.acks={},a.flags={},a.io=e,a.nsp=n,o&&o.auth&&(a.auth=o.auth),a.io._autoConnect&&a.open(),a}return s(r,[{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[Be(e,"open",this.onopen.bind(this)),Be(e,"packet",this.onpacket.bind(this)),Be(e,"error",this.onerror.bind(this)),Be(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(Ue.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.unshift(e);var o={type:Fe.EVENT,data:r,options:{}};if(o.options.compress=!1!==this.flags.compress,"function"==typeof r[r.length-1]){var i=this.ids++,a=r.pop();this._registerAckCallback(i,a),o.id=i}var s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,c=this.flags.volatile&&(!s||!this.connected);return c||(this.connected?this.packet(o):this.sendBuffer.push(o)),this.flags={},this}},{key:"_registerAckCallback",value:function(e,t){var r=this,n=this.flags.timeout;if(void 0!==n){var o=this.io.setTimeoutFn((function(){delete r.acks[e];for(var n=0;n<r.sendBuffer.length;n++)r.sendBuffer[n].id===e&&r.sendBuffer.splice(n,1);t.call(r,new Error("operation has timed out"))}),n);this.acks[e]=function(){r.io.clearTimeoutFn(o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.apply(r,[null].concat(n))}}else this.acks[e]=t}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;"function"==typeof this.auth?this.auth((function(t){e.packet({type:Fe.CONNECT,data:t})})):this.packet({type:Fe.CONNECT,data:this.auth})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case Fe.CONNECT:if(e.data&&e.data.sid){var t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Fe.EVENT:case Fe.BINARY_EVENT:this.onevent(e);break;case Fe.ACK:case Fe.BINARY_ACK:this.onack(e);break;case Fe.DISCONNECT:this.ondisconnect();break;case Fe.CONNECT_ERROR:this.destroy();var r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,n=C(this._anyListeners.slice());try{for(n.s();!(t=n.n()).done;){t.value.apply(this,e)}}catch(e){n.e(e)}finally{n.f()}}b(f(r.prototype),"emit",this).apply(this,e)}},{key:"ack",value:function(e){var t=this,r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];t.packet({type:Fe.ACK,id:e,data:o})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e){this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach((function(t){return e.emitEvent(t)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(t){return e.packet(t)})),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach((function(e){return e()})),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:Fe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}}]),r}(B),We=qe;function qe(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}qe.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},qe.prototype.reset=function(){this.attempts=0},qe.prototype.setMin=function(e){this.ms=e},qe.prototype.setMax=function(e){this.max=e},qe.prototype.setJitter=function(e){this.jitter=e};var Ve=function(e){u(n,e);var t=m(n);function n(e,o){var a,s;i(this,n),(a=t.call(this)).nsps={},a.subs=[],e&&"object"===r(e)&&(o=e,e=void 0),(o=o||{}).path=o.path||"/socket.io",a.opts=o,H(y(a),o),a.reconnection(!1!==o.reconnection),a.reconnectionAttempts(o.reconnectionAttempts||1/0),a.reconnectionDelay(o.reconnectionDelay||1e3),a.reconnectionDelayMax(o.reconnectionDelayMax||5e3),a.randomizationFactor(null!==(s=o.randomizationFactor)&&void 0!==s?s:.5),a.backoff=new We({min:a.reconnectionDelay(),max:a.reconnectionDelayMax(),jitter:a.randomizationFactor()}),a.timeout(null==o.timeout?2e4:o.timeout),a._readyState="closed",a.uri=e;var c=o.parser||He;return a.encoder=new c.Encoder,a.decoder=new c.Decoder,a._autoConnect=!1!==o.autoConnect,a._autoConnect&&a.open(),a}return s(n,[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(~this._readyState.indexOf("open"))return this;this.engine=new Se(this.uri,this.opts);var r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;var o=Be(r,"open",(function(){n.onopen(),e&&e()})),i=Be(r,"error",(function(r){n.cleanup(),n._readyState="closed",t.emitReserved("error",r),e?e(r):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){var a=this._timeout;0===a&&o();var s=this.setTimeoutFn((function(){o(),r.close(),r.emit("error",new Error("timeout"))}),a);this.opts.autoUnref&&s.unref(),this.subs.push((function(){clearTimeout(s)}))}return this.subs.push(o),this.subs.push(i),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(Be(e,"ping",this.onping.bind(this)),Be(e,"data",this.ondata.bind(this)),Be(e,"error",this.onerror.bind(this)),Be(e,"close",this.onclose.bind(this)),Be(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){this.decoder.add(e)}},{key:"ondecoded",value:function(e){this.emitReserved("packet",e)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var r=this.nsps[e];return r||(r=new Je(this,e,t),this.nsps[e]=r),r}},{key:"_destroy",value:function(e){for(var t=0,r=Object.keys(this.nsps);t<r.length;t++){var n=r[t];if(this.nsps[n].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),r=0;r<t.length;r++)this.engine.write(t[r],e.options)}},{key:"cleanup",value:function(){this.subs.forEach((function(e){return e()})),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var r=this.backoff.duration();this._reconnecting=!0;var n=this.setTimeoutFn((function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((function(r){r?(t._reconnecting=!1,t.reconnect(),e.emitReserved("reconnect_error",r)):t.onreconnect()})))}),r);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}]),n}(B),Ke={};function ze(e,t){"object"===r(e)&&(t=e,e=void 0);var n,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=e;r=r||"undefined"!=typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),n=P(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port+t,n.href=n.protocol+"://"+o+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),i=o.source,a=o.id,s=o.path,c=Ke[a]&&s in Ke[a].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||c?n=new Ve(i,t):(Ke[a]||(Ke[a]=new Ve(i,t)),n=Ke[a]),o.query&&!t.query&&(t.query=o.queryKey),n.socket(o.path,t)}Object.assign(ze,{Manager:Ve,Socket:Je,io:ze,connect:ze});var Ge={exports:{}},Ye=1e3,$e=6e4,Xe=60*$e,Ze=24*Xe,Qe=7*Ze,et=365.25*Ze,tt=function(e,t){t=t||{};var n=r(e);if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*et;case"weeks":case"week":case"w":return r*Qe;case"days":case"day":case"d":return r*Ze;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Xe;case"minutes":case"minute":case"mins":case"min":case"m":return r*$e;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ye;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===n&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=Ze)return rt(e,t,Ze,"day");if(t>=Xe)return rt(e,t,Xe,"hour");if(t>=$e)return rt(e,t,$e,"minute");if(t>=Ye)return rt(e,t,Ye,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=Ze)return Math.round(e/Ze)+"d";if(t>=Xe)return Math.round(e/Xe)+"h";if(t>=$e)return Math.round(e/$e)+"m";if(t>=Ye)return Math.round(e/Ye)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function rt(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}var nt,ot,it,at=function(e){function t(e){var n,o,i,a=null;function s(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];if(s.enabled){var i=s,a=Number(new Date),c=a-(n||a);i.diff=c,i.prev=n,i.curr=a,n=a,r[0]=t.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");var u=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return"%";u++;var o=t.formatters[n];if("function"==typeof o){var a=r[u];e=o.call(i,a),r.splice(u,1),u--}return e})),t.formatArgs.call(i,r);var f=i.log||t.log;f.apply(i,r)}}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i)},set:function(e){a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,r){var n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(w(t.names.map(n)),w(t.skips.map(n).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=tt,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t};nt=Ge,(ot=Ge.exports).formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+nt.exports.humanize(this.diff),this.useColors){var t="color: "+this.color;e.splice(1,0,t,"color: inherit");var r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(n=r))})),e.splice(n,0,t)}},ot.save=function(e){try{e?ot.storage.setItem("debug",e):ot.storage.removeItem("debug")}catch(e){}},ot.load=function(){var e;try{e=ot.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},ot.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},ot.storage=function(){try{return localStorage}catch(e){}}(),ot.destroy=(it=!1,function(){it||(it=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),ot.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],ot.log=console.debug||console.log||function(){},nt.exports=at(ot),nt.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}};var st,ct=Ge.exports,ut={exports:{}},ft="object"===("undefined"==typeof Reflect?"undefined":r(Reflect))?Reflect:null,lt=ft&&"function"==typeof ft.apply?ft.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};st=ft&&"function"==typeof ft.ownKeys?ft.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var ht=Number.isNaN||function(e){return e!=e};function pt(){pt.init.call(this)}ut.exports=pt,ut.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}Ct(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&Ct(e,"error",t,r)}(e,o,{once:!0})}))},pt.EventEmitter=pt,pt.prototype._events=void 0,pt.prototype._eventsCount=0,pt.prototype._maxListeners=void 0;var dt=10;function yt(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(e))}function vt(e){return void 0===e._maxListeners?pt.defaultMaxListeners:e._maxListeners}function mt(e,t,r,n){var o,i,a,s;if(yt(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),a=i[t]),void 0===a)a=i[t]=r,++e._eventsCount;else if("function"==typeof a?a=i[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(o=vt(e))>0&&a.length>o&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function gt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function bt(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=gt.bind(n);return o.listener=r,n.wrapFn=o,o}function wt(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):Et(o,o.length)}function kt(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function Et(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Ct(e,t,n,o){if("function"==typeof e.on)o.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+r(e));e.addEventListener(t,(function r(i){o.once&&e.removeEventListener(t,r),n(i)}))}}Object.defineProperty(pt,"defaultMaxListeners",{enumerable:!0,get:function(){return dt},set:function(e){if("number"!=typeof e||e<0||ht(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");dt=e}}),pt.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},pt.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||ht(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},pt.prototype.getMaxListeners=function(){return vt(this)},pt.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var s=o[e];if(void 0===s)return!1;if("function"==typeof s)lt(s,this,t);else{var c=s.length,u=Et(s,c);for(r=0;r<c;++r)lt(u[r],this,t)}return!0},pt.prototype.addListener=function(e,t){return mt(this,e,t,!1)},pt.prototype.on=pt.prototype.addListener,pt.prototype.prependListener=function(e,t){return mt(this,e,t,!0)},pt.prototype.once=function(e,t){return yt(t),this.on(e,bt(this,e,t)),this},pt.prototype.prependOnceListener=function(e,t){return yt(t),this.prependListener(e,bt(this,e,t)),this},pt.prototype.removeListener=function(e,t){var r,n,o,i,a;if(yt(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){a=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},pt.prototype.off=pt.prototype.removeListener,pt.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},pt.prototype.listeners=function(e){return wt(this,e,!0)},pt.prototype.rawListeners=function(e){return wt(this,e,!1)},pt.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):kt.call(e,t)},pt.prototype.listenerCount=kt,pt.prototype.eventNames=function(){return this._eventsCount>0?st(this._events):[]};!function(e){var t=function(e){var t,n=Object.prototype,o=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,i=Object.create(o.prototype),a=new O(n||[]);return i._invoke=function(e,t,r){var n=h;return function(o,i){if(n===d)throw new Error("Generator is already running");if(n===y){if("throw"===o)throw i;return P()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=A(a,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var c=l(e,t,r);if("normal"===c.type){if(n=r.done?y:p,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=y,r.method="throw",r.arg=c.arg)}}}(e,r,a),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=f;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(R([])));E&&E!==n&&o.call(E,a)&&(w=E);var C=b.prototype=m.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(i,a,s,c){var u=l(e[i],e,a);if("throw"!==u.type){var f=u.arg,h=f.value;return h&&"object"===r(h)&&o.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(h).then((function(e){f.value=e,s(f)}),(function(e){return n("throw",e,s,c)}))}c(u.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}}function A(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=l(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function R(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}return{next:P}}function P(){return{value:t,done:!0}}return g.prototype=b,u(C,"constructor",b),u(b,"constructor",g),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},S(_.prototype),u(_.prototype,s,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new _(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(C),u(C,c,"Generator"),u(C,a,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=R,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:R(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}({exports:{}});var St=crypto;function _t(e){try{return null!=e&&"boolean"==typeof e.extractable&&"string"==typeof e.algorithm.name&&"string"==typeof e.type}catch(e){return!1}}var At=new TextEncoder,xt=new TextDecoder;function Tt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.reduce((function(e,t){return e+t.length}),0),o=new Uint8Array(n),i=0;return t.forEach((function(e){o.set(e,i),i+=e.length})),o}var Ot=function(e){return function(e){var t=e;"string"==typeof t&&(t=At.encode(t));for(var r=[],n=0;n<t.length;n+=32768)r.push(String.fromCharCode.apply(null,t.subarray(n,n+32768)));return btoa(r.join(""))}(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},Rt=function(e){var t=e;t instanceof Uint8Array&&(t=xt.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return function(e){return new Uint8Array(atob(e).split("").map((function(e){return e.charCodeAt(0)})))}(t)}catch(e){throw new TypeError("The input to be decoded is not correctly encoded.")}},Pt=function(e){u(r,e);var t=m(r);function r(e){var n,o;return i(this,r),(n=t.call(this,e)).code="ERR_JOSE_GENERIC",n.name=n.constructor.name,null===(o=Error.captureStackTrace)||void 0===o||o.call(Error,y(n),n.constructor),n}return s(r,null,[{key:"code",get:function(){return"ERR_JOSE_GENERIC"}}]),r}(d(Error)),Lt=function(e){u(r,e);var t=m(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unspecified",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified";return i(this,r),(n=t.call(this,e)).code="ERR_JWT_CLAIM_VALIDATION_FAILED",n.claim=o,n.reason=a,n}return s(r,null,[{key:"code",get:function(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}}]),r}(Pt),jt=function(e){u(r,e);var t=m(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unspecified",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified";return i(this,r),(n=t.call(this,e)).code="ERR_JWT_EXPIRED",n.claim=o,n.reason=a,n}return s(r,null,[{key:"code",get:function(){return"ERR_JWT_EXPIRED"}}]),r}(Pt),Nt=function(e){u(r,e);var t=m(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).code="ERR_JOSE_ALG_NOT_ALLOWED",e}return s(r,null,[{key:"code",get:function(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}]),r}(Pt),Ft=function(e){u(r,e);var t=m(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).code="ERR_JOSE_NOT_SUPPORTED",e}return s(r,null,[{key:"code",get:function(){return"ERR_JOSE_NOT_SUPPORTED"}}]),r}(Pt),Mt=function(e){u(r,e);var t=m(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).code="ERR_JWS_INVALID",e}return s(r,null,[{key:"code",get:function(){return"ERR_JWS_INVALID"}}]),r}(Pt),Dt=function(e){u(r,e);var t=m(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).code="ERR_JWT_INVALID",e}return s(r,null,[{key:"code",get:function(){return"ERR_JWT_INVALID"}}]),r}(Pt),It=function(e){u(r,e);var t=m(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",e.message="signature verification failed",e}return s(r,null,[{key:"code",get:function(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}]),r}(Pt);function Ht(){return"function"==typeof WebSocketPair}function Bt(){try{return void 0!==process.versions.node}catch(e){return!1}}function Ut(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"algorithm.name";return new TypeError("CryptoKey does not support this operation, its ".concat(t," must be ").concat(e))}function Jt(e,t){return e.name===t}function Wt(e){return parseInt(e.name.slice(4),10)}function qt(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function Vt(e,t){if(t.length&&!t.some((function(t){return e.usages.includes(t)}))){var r="CryptoKey does not support this operation, its usages must include ";if(t.length>2){var n=t.pop();r+="one of ".concat(t.join(", "),", or ").concat(n,".")}else 2===t.length?r+="one of ".concat(t[0]," or ").concat(t[1],"."):r+="".concat(t[0],".");throw new TypeError(r)}}var Kt=function(e){for(var t="Key must be ",n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];if(o.length>2){var a=o.pop();t+="one of type ".concat(o.join(", "),", or ").concat(a,".")}else 2===o.length?t+="one of type ".concat(o[0]," or ").concat(o[1],"."):t+="of type ".concat(o[0],".");return null==e?t+=" Received ".concat(e):"function"==typeof e&&e.name?t+=" Received function ".concat(e.name):"object"===r(e)&&null!=e&&e.constructor&&e.constructor.name&&(t+=" Received an instance of ".concat(e.constructor.name)),t},zt=function(e){return _t(e)},Gt=["CryptoKey"],Yt=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,o=t.filter(Boolean);if(0===o.length||1===o.length)return!0;var i,a=C(o);try{for(a.s();!(i=a.n()).done;){var s=i.value,c=Object.keys(s);if(n&&0!==n.size)for(var u=0,f=c;u<f.length;u++){var l=f[u];if(n.has(l))return!1;n.add(l)}else n=new Set(c)}}catch(e){a.e(e)}finally{a.f()}return!0};function $t(e){if("object"!==r(t=e)||null===t||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t;if(null===Object.getPrototypeOf(e))return!0;for(var n=e;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}var Xt=function(e,t){if(e.startsWith("RS")||e.startsWith("PS")){var r=t.algorithm.modulusLength;if("number"!=typeof r||r<2048)throw new TypeError("".concat(e," requires key modulusLength to be 2048 bits or larger"))}},Zt=function(e,t,r){e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?function(e){if(!(e instanceof Uint8Array)){if(!zt(e))throw new TypeError(Kt.apply(void 0,[e].concat(w(Gt),["Uint8Array"])));if("secret"!==e.type)throw new TypeError("".concat(Gt.join(" or "),' instances for symmetric algorithms must be of type "secret"'))}}(t):function(e,t){if(!zt(e))throw new TypeError(Kt.apply(void 0,[e].concat(w(Gt))));if("secret"===e.type)throw new TypeError("".concat(Gt.join(" or "),' instances for asymmetric algorithms must not be of type "secret"'));if("sign"===t&&"public"===e.type)throw new TypeError("".concat(Gt.join(" or "),' instances for asymmetric algorithm signing must be of type "private"'));if("decrypt"===t&&"public"===e.type)throw new TypeError("".concat(Gt.join(" or "),' instances for asymmetric algorithm decryption must be of type "private"'));if(e.algorithm&&"verify"===t&&"private"===e.type)throw new TypeError("".concat(Gt.join(" or "),' instances for asymmetric algorithm verifying must be of type "public"'));if(e.algorithm&&"encrypt"===t&&"private"===e.type)throw new TypeError("".concat(Gt.join(" or "),' instances for asymmetric algorithm encryption must be of type "public"'))}(t,r)};function Qt(e,t,r,n,o){if(void 0!==o.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some((function(e){return"string"!=typeof e||0===e.length})))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');var i;i=void 0!==r?new Map([].concat(w(Object.entries(r)),w(t.entries()))):t;var a,s=C(n.crit);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(!i.has(c))throw new Ft('Extension Header Parameter "'.concat(c,'" is not recognized'));if(void 0===o[c])throw new e('Extension Header Parameter "'.concat(c,'" is missing'));if(i.get(c)&&void 0===n[c])throw new e('Extension Header Parameter "'.concat(c,'" MUST be integrity protected'))}}catch(e){s.e(e)}finally{s.f()}return new Set(n.crit)}var er=function(e,t){if(void 0!==t&&(!Array.isArray(t)||t.some((function(e){return"string"!=typeof e}))))throw new TypeError('"'.concat(e,'" option must be an array of strings'));if(t)return new Set(t)};function tr(e,t){var r="SHA-".concat(e.slice(-3));switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case(Ht()||Bt())&&"EdDSA":var n=t.namedCurve;return{name:n,namedCurve:n};default:throw new Ft("alg ".concat(e," is not supported either by JOSE or your javascript runtime"))}}function rr(e,t,r){if(_t(t))return function(e,t){switch(t){case"HS256":case"HS384":case"HS512":if(!Jt(e.algorithm,"HMAC"))throw Ut("HMAC");var r=parseInt(t.slice(2),10);if(Wt(e.algorithm.hash)!==r)throw Ut("SHA-".concat(r),"algorithm.hash");break;case"RS256":case"RS384":case"RS512":if(!Jt(e.algorithm,"RSASSA-PKCS1-v1_5"))throw Ut("RSASSA-PKCS1-v1_5");var n=parseInt(t.slice(2),10);if(Wt(e.algorithm.hash)!==n)throw Ut("SHA-".concat(n),"algorithm.hash");break;case"PS256":case"PS384":case"PS512":if(!Jt(e.algorithm,"RSA-PSS"))throw Ut("RSA-PSS");var o=parseInt(t.slice(2),10);if(Wt(e.algorithm.hash)!==o)throw Ut("SHA-".concat(o),"algorithm.hash");break;case Bt()&&"EdDSA":if("NODE-ED25519"!==e.algorithm.name&&"NODE-ED448"!==e.algorithm.name)throw Ut("NODE-ED25519 or NODE-ED448");break;case Ht()&&"EdDSA":if(!Jt(e.algorithm,"NODE-ED25519"))throw Ut("NODE-ED25519");break;case"ES256":case"ES384":case"ES512":if(!Jt(e.algorithm,"ECDSA"))throw Ut("ECDSA");var i=qt(t);if(e.algorithm.namedCurve!==i)throw Ut(i,"algorithm.namedCurve");break;default:throw new TypeError("CryptoKey does not support this operation")}for(var a=arguments.length,s=new Array(a>2?a-2:0),c=2;c<a;c++)s[c-2]=arguments[c];Vt(e,s)}(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(Kt.apply(void 0,[t].concat(w(Gt))));return St.subtle.importKey("raw",t,{hash:"SHA-".concat(e.slice(-3)),name:"HMAC"},!1,[r])}throw new TypeError(Kt.apply(void 0,[t].concat(w(Gt),["Uint8Array"])))}var nr=function(){var e=o(regeneratorRuntime.mark((function e(t,r,n,o){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rr(t,r,"verify");case 2:return i=e.sent,Xt(t,i),a=tr(t,i.algorithm),e.prev=5,e.next=8,St.subtle.verify(a,i,n,o);case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(5),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t,r,n,o){return e.apply(this,arguments)}}();function or(e,t,r){return ir.apply(this,arguments)}function ir(){return(ir=o(regeneratorRuntime.mark((function e(r,n,o){var i,a,s,c,u,f,l,h,p,d,y,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($t(r)){e.next=2;break}throw new Mt("Flattened JWS must be an object");case 2:if(void 0!==r.protected||void 0!==r.header){e.next=4;break}throw new Mt('Flattened JWS must have either of the "protected" or "header" members');case 4:if(void 0===r.protected||"string"==typeof r.protected){e.next=6;break}throw new Mt("JWS Protected Header incorrect type");case 6:if(void 0!==r.payload){e.next=8;break}throw new Mt("JWS Payload missing");case 8:if("string"==typeof r.signature){e.next=10;break}throw new Mt("JWS Signature missing or incorrect type");case 10:if(void 0===r.header||$t(r.header)){e.next=12;break}throw new Mt("JWS Unprotected Header incorrect type");case 12:if(a={},!r.protected){e.next=22;break}s=Rt(r.protected),e.prev=15,a=JSON.parse(xt.decode(s)),e.next=22;break;case 19:throw e.prev=19,e.t0=e.catch(15),new Mt("JWS Protected Header is invalid");case 22:if(Yt(a,r.header)){e.next=24;break}throw new Mt("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");case 24:if(c=t(t({},a),r.header),u=Qt(Mt,new Map([["b64",!0]]),null==o?void 0:o.crit,a,c),f=!0,!u.has("b64")){e.next=31;break}if("boolean"==typeof(f=a.b64)){e.next=31;break}throw new Mt('The "b64" (base64url-encode payload) Header Parameter must be a boolean');case 31:if("string"==typeof(l=c.alg)&&l){e.next=34;break}throw new Mt('JWS "alg" (Algorithm) Header Parameter missing or invalid');case 34:if(!(h=o&&er("algorithms",o.algorithms))||h.has(l)){e.next=37;break}throw new Nt('"alg" (Algorithm) Header Parameter not allowed');case 37:if(!f){e.next=42;break}if("string"==typeof r.payload){e.next=40;break}throw new Mt("JWS Payload must be a string");case 40:e.next=44;break;case 42:if("string"==typeof r.payload||r.payload instanceof Uint8Array){e.next=44;break}throw new Mt("JWS Payload must be a string or an Uint8Array instance");case 44:if(p=!1,"function"!=typeof n){e.next=50;break}return e.next=48,n(a,r);case 48:n=e.sent,p=!0;case 50:return Zt(l,n,"verify"),d=Tt(At.encode(null!==(i=r.protected)&&void 0!==i?i:""),At.encode("."),"string"==typeof r.payload?At.encode(r.payload):r.payload),y=Rt(r.signature),e.next=55,nr(l,n,y,d);case 55:if(e.sent){e.next=58;break}throw new It;case 58:if(v=f?Rt(r.payload):"string"==typeof r.payload?At.encode(r.payload):r.payload,m={payload:v},void 0!==r.protected&&(m.protectedHeader=a),void 0!==r.header&&(m.unprotectedHeader=r.header),!p){e.next=64;break}return e.abrupt("return",t(t({},m),{},{key:n}));case 64:return e.abrupt("return",m);case 65:case"end":return e.stop()}}),e,null,[[15,19]])})))).apply(this,arguments)}function ar(e,t,r){return sr.apply(this,arguments)}function sr(){return(sr=o(regeneratorRuntime.mark((function e(r,n,o){var i,a,s,c,u,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r instanceof Uint8Array&&(r=xt.decode(r)),"string"==typeof r){e.next=3;break}throw new Mt("Compact JWS must be a string or Uint8Array");case 3:if(i=r.split("."),a=i[0],s=i[1],c=i[2],3===i.length){e.next=6;break}throw new Mt("Invalid Compact JWS");case 6:return e.next=8,or({payload:s,protected:a,signature:c},n,o);case 8:if(u=e.sent,f={payload:u.payload,protectedHeader:u.protectedHeader},"function"!=typeof n){e.next=12;break}return e.abrupt("return",t(t({},f),{},{key:u.key}));case 12:return e.abrupt("return",f);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var cr=function(e){return Math.floor(e.getTime()/1e3)},ur=86400,fr=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,lr=function(e){var t=fr.exec(e);if(!t)throw new TypeError("Invalid time period format");var r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(r*ur);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(31557600*r)}},hr=function(e){return e.toLowerCase().replace(/^application\//,"")},pr=function(e,t){return"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)))},dr=function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.typ;if(i&&("string"!=typeof e.typ||hr(e.typ)!==hr(i)))throw new Lt('unexpected "typ" JWT header value',"typ","check_failed");try{n=JSON.parse(xt.decode(t))}catch(e){}if(!$t(n))throw new Dt("JWT Claims Set must be a top-level JSON object");var a=o.issuer;if(a&&!(Array.isArray(a)?a:[a]).includes(n.iss))throw new Lt('unexpected "iss" claim value',"iss","check_failed");var s=o.subject;if(s&&n.sub!==s)throw new Lt('unexpected "sub" claim value',"sub","check_failed");var c,u=o.audience;if(u&&!pr(n.aud,"string"==typeof u?[u]:u))throw new Lt('unexpected "aud" claim value',"aud","check_failed");switch(r(o.clockTolerance)){case"string":c=lr(o.clockTolerance);break;case"number":c=o.clockTolerance;break;case"undefined":c=0;break;default:throw new TypeError("Invalid clockTolerance option type")}var f=o.currentDate,l=cr(f||new Date);if(void 0!==n.iat||o.maxTokenAge){if("number"!=typeof n.iat)throw new Lt('"iat" claim must be a number',"iat","invalid");if(void 0===n.exp&&n.iat>l+c)throw new Lt('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}if(void 0!==n.nbf){if("number"!=typeof n.nbf)throw new Lt('"nbf" claim must be a number',"nbf","invalid");if(n.nbf>l+c)throw new Lt('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==n.exp){if("number"!=typeof n.exp)throw new Lt('"exp" claim must be a number',"exp","invalid");if(n.exp<=l-c)throw new jt('"exp" claim timestamp check failed',"exp","check_failed")}if(o.maxTokenAge){var h=l-n.iat,p="number"==typeof o.maxTokenAge?o.maxTokenAge:lr(o.maxTokenAge);if(h-c>p)throw new jt('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(h<0-c)throw new Lt('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return n};function yr(e,t,r){return vr.apply(this,arguments)}function vr(){return(vr=o(regeneratorRuntime.mark((function e(r,n,o){var i,a,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ar(r,n,o);case 2:if(a=e.sent,!(null===(i=a.protectedHeader.crit)||void 0===i?void 0:i.includes("b64"))||!1!==a.protectedHeader.b64){e.next=5;break}throw new Dt("JWTs MUST NOT use unencoded payload");case 5:if(s=dr(a.protectedHeader,a.payload,o),c={payload:s,protectedHeader:a.protectedHeader},"function"!=typeof n){e.next=9;break}return e.abrupt("return",t(t({},c),{},{key:a.key}));case 9:return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var mr=function(){var e=o(regeneratorRuntime.mark((function e(t,r,n){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rr(t,r,"sign");case 2:return o=e.sent,Xt(t,o),e.next=6,St.subtle.sign(tr(t,o.algorithm),o,n);case 6:return i=e.sent,e.abrupt("return",new Uint8Array(i));case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),gr=function(){function e(t){if(i(this,e),!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=t}var r;return s(e,[{key:"setProtectedHeader",value:function(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}},{key:"setUnprotectedHeader",value:function(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}},{key:"sign",value:(r=o(regeneratorRuntime.mark((function e(r,n){var o,i,a,s,c,u,f,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._protectedHeader||this._unprotectedHeader){e.next=2;break}throw new Mt("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");case 2:if(Yt(this._protectedHeader,this._unprotectedHeader)){e.next=4;break}throw new Mt("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");case 4:if(o=t(t({},this._protectedHeader),this._unprotectedHeader),i=Qt(Mt,new Map([["b64",!0]]),null==n?void 0:n.crit,this._protectedHeader,o),a=!0,!i.has("b64")){e.next=11;break}if("boolean"==typeof(a=this._protectedHeader.b64)){e.next=11;break}throw new Mt('The "b64" (base64url-encode payload) Header Parameter must be a boolean');case 11:if("string"==typeof(s=o.alg)&&s){e.next=14;break}throw new Mt('JWS "alg" (Algorithm) Header Parameter missing or invalid');case 14:return Zt(s,r,"sign"),c=this._payload,a&&(c=At.encode(Ot(c))),u=this._protectedHeader?At.encode(Ot(JSON.stringify(this._protectedHeader))):At.encode(""),f=Tt(u,At.encode("."),c),e.next=21,mr(s,r,f);case 21:return l=e.sent,h={signature:Ot(l),payload:""},a&&(h.payload=xt.decode(c)),this._unprotectedHeader&&(h.header=this._unprotectedHeader),this._protectedHeader&&(h.protected=xt.decode(u)),e.abrupt("return",h);case 27:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})}]),e}(),br=function(){function e(t){i(this,e),this._flattened=new gr(t)}var t;return s(e,[{key:"setProtectedHeader",value:function(e){return this._flattened.setProtectedHeader(e),this}},{key:"sign",value:(t=o(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._flattened.sign(t,r);case 2:if(void 0!==(n=e.sent).payload){e.next=5;break}throw new TypeError("use the flattened module for creating JWS with b64: false");case 5:return e.abrupt("return","".concat(n.protected,".").concat(n.payload,".").concat(n.signature));case 6:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}(),wr=function(e){u(n,e);var t,r=m(n);function n(){return i(this,n),r.apply(this,arguments)}return s(n,[{key:"setProtectedHeader",value:function(e){return this._protectedHeader=e,this}},{key:"sign",value:(t=o(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=new br(At.encode(JSON.stringify(this._payload)))).setProtectedHeader(this._protectedHeader),!Array.isArray(null===(n=this._protectedHeader)||void 0===n?void 0:n.crit)||!this._protectedHeader.crit.includes("b64")||!1!==this._protectedHeader.b64){e.next=4;break}throw new Dt("JWTs MUST NOT use unencoded payload");case 4:return e.abrupt("return",o.sign(t,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),n}(function(){function e(t){if(i(this,e),!$t(t))throw new TypeError("JWT Claims Set MUST be an object");this._payload=t}return s(e,[{key:"setIssuer",value:function(e){return this._payload=t(t({},this._payload),{},{iss:e}),this}},{key:"setSubject",value:function(e){return this._payload=t(t({},this._payload),{},{sub:e}),this}},{key:"setAudience",value:function(e){return this._payload=t(t({},this._payload),{},{aud:e}),this}},{key:"setJti",value:function(e){return this._payload=t(t({},this._payload),{},{jti:e}),this}},{key:"setNotBefore",value:function(e){return this._payload=t(t({},this._payload),{},"number"==typeof e?{nbf:e}:{nbf:cr(new Date)+lr(e)}),this}},{key:"setExpirationTime",value:function(e){return this._payload=t(t({},this._payload),{},"number"==typeof e?{exp:e}:{exp:cr(new Date)+lr(e)}),this}},{key:"setIssuedAt",value:function(e){return this._payload=t(t({},this._payload),{},void 0===e?{iat:cr(new Date)}:{iat:e}),this}}]),e}()),kr=ct("Socket"),Er=ct("Peer"),Cr=ct("Remote"),Sr=function(e){function t(t){var r=t.secret,n=t.room,o=t.hasVideo,i=t.hasAudio,a=e.call(this)||this;return a.handleMessage=function(e){var t=e.type,r=e.from,n=e.to,o=e.room,i=e.token;return _(a,void 0,void 0,(function(){var e,a,s,c;return A(this,(function(u){switch(u.label){case 0:return u.trys.push([0,11,,12]),[4,yr(i,this.secret)];case 1:if(!(e=u.sent()))return[3,10];switch(t){case"peer-connection-request":return[3,2];case"data":return[3,3];case"track-update":return[3,4];case"socket-update":return[3,5];case"error":return[3,6];case"ping":return[3,7]}return[3,9];case 2:return this.onPeerConnectRequest({from:r,to:n,data:e}),[3,10];case 3:return this.handlePeerData({from:r,to:n,data:e}),[3,10];case 4:return this.handleTrackUpdate(e),[3,10];case 5:return this.handleSocketUpdate(e),[3,10];case 6:return a=e.error,kr("Socket Server Error",a),this.emit("error",a),[3,10];case 7:return kr("PING from socket server."),[4,this.getStats()];case 8:return s=u.sent(),this.sendMessage("PONG",{data:s}),[3,10];case 9:return kr("Unknown Event Type",{type:t,from:r,to:n,room:o,data:e}),[3,10];case 10:return[3,12];case 11:return c=u.sent(),kr("Token Decoding Error",c),[3,12];case 12:return[2]}}))}))},a.onPeerConnectRequest=function(e){var t=e.from,r=e.to,n=e.data,o=n.response,i=n.peerName;o&&a.sendMessage("connection-request",{from:r,to:t,data:{response:!1,peerName:a.name}}),kr("New Peer Connected. Waiting for an offer"),a.peers.set(i,new RTCPeerConnection({iceServers:a.iceServers}));var s=a.peers.get(i);Cr("Adding Tracks",a.streams),a.streams.getTracks().forEach((function(e){s.addTrack(e,a.streams)})),Cr("Tracks Added"),s.ontrack=function(e){var t=e.currentTarget.to;a.remoteStreams.set(t.name,e.streams),a.emit("new-remote-track",e)},s.onicecandidate=function(e){if(e.candidate){Cr("ICE Candidate",e);var t=e.currentTarget;a.sendMessage("data",{from:t.from.socket,to:t.to.socket,data:{name:s.from.name,candidate:e.candidate}})}},s.onnegotiationneeded=function(e){return _(a,void 0,void 0,(function(){var t,r,n;return A(this,(function(o){switch(o.label){case 0:t=e.currentTarget,o.label=1;case 1:return o.trys.push([1,4,5,6]),t.makingOffer=!0,Cr("Negotiation needed",e),[4,t.createOffer()];case 2:return r=o.sent(),Cr("Offer Generated",r),"stable"!=t.signalingState?[2]:[4,t.setLocalDescription(r)];case 3:return o.sent(),Cr("Local Description Set",t.localDescription),this.sendMessage("data",{to:t.to.socket,from:t.from.socket,data:{name:t.from.name,sdp:t.localDescription}}),[3,6];case 4:return n=o.sent(),console.error(new Error(n)),[3,6];case 5:return t.makingOffer=!1,[7];case 6:return[2]}}))}))},s.onconnectionstatechange=function(e){switch(s.connectionState){case"new":case"connecting":Cr("Connecting...");break;case"connected":Cr("Connected."),a.emit("new-peer",s),s.checkConnection();break;case"disconnected":Cr("Disconnecting..."),s.checkConnection();break;case"closed":Cr("Offline");break;case"failed":Cr("Error"),s.checkConnection()}},s.checkConnection=function(){var e=s.connectionState,t=s.iceConnectionState,r=s.iceGatheringState,n=s.signalingState;"connected"===e&&"connected"===t&&"complete"===r&&"stable"===n?Cr("Connection Established."):"disconnected"!==e&&"closed"!==e&&"failed"!==e||"disconnected"!==t&&"failed"!==t&&"closed"!==t||(Cr("Error in Connection Establishment"),a.emit("peer-left",s.to.name),a.removePeer(s.to.name))},s.from={name:a.name,socket:a.socket.id},s.to={name:i,socket:t},s.initiator=o,s.ignoreOffer=!1,s.makingOffer=!1,s.socket=a.socket,s.poster=a.createPoster(i)},a.handlePeerData=function(e){var t=e.to,r=e.from,n=e.data;return _(a,void 0,void 0,(function(){var e,o,i,a,s,c,u,f;return A(this,(function(l){switch(l.label){case 0:if(e=n.name,o=n.sdp,i=n.candidate,!this.peers.has(e)||t!==this.socket.id)return[3,15];l.label=1;case 1:return l.trys.push([1,14,,15]),a=this.peers.get(e),Er("Data recieved",{name:e,sdp:o,candidate:i}),o?(s="offer"===o.type&&(a.makingOffer||"stable"!==a.signalingState),a.ignoreOffer=!a.initiator&&s,a.ignoreOffer?[2]:s?[4,Promise.all([a.setLocalDescription({type:"rollback"}),a.setRemoteDescription(o)])]:[3,3]):[3,9];case 2:return l.sent(),[3,5];case 3:return Er("Answer Recieved",o),[4,a.setRemoteDescription(o)];case 4:l.sent(),l.label=5;case 5:return"offer"!==o.type?[3,8]:[4,a.createAnswer()];case 6:return c=l.sent(),Er("Answer Created",c),[4,a.setLocalDescription(c)];case 7:l.sent(),Er("Local description set as answer",a.localDescription),this.sendMessage("data",{to:r,from:t,data:{name:this.name,sdp:a.localDescription}}),l.label=8;case 8:return[3,13];case 9:if(!i)return[3,13];l.label=10;case 10:return l.trys.push([10,12,,13]),[4,a.addIceCandidate(i)];case 11:return l.sent(),Er("Added Ice Candidate",i),[3,13];case 12:return u=l.sent(),a.ignoreOffer?Er("Should be ignored",u,i,this.peers.has(e),t===this.socket.id):Er("Error adding IceCandidate",u),[3,13];case 13:return[3,15];case 14:return f=l.sent(),kr("Socket Error",f),[3,15];case 15:return[2]}}))}))},a.handleTrackUpdate=function(e){var t=e.id,r=e.update;switch(kr("Track Update Recieved",t,r),r){case"mute":a.emit("remote-peer-track-muted",t);break;case"unmute":a.emit("remote-peer-track-unmuted",t);break;case"end":a.remoteStreams.get(t).forEach((function(e){return e.getVideoTracks()[0].stop()})),a.emit("remote-peer-track-ended",t)}},a.handleSocketUpdate=function(e){var t=e.id,r=e.name;a.peers.get(r).to.socket=t,kr("Socket ID updated for peer.")},a.getStats=function(){return new Promise((function(e,t){return _(a,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,u,f,l;return A(this,(function(h){switch(h.label){case 0:t={},h.label=1;case 1:h.trys.push([1,6,7,8]),r=x(this.peers),n=r.next(),h.label=2;case 2:return n.done?[3,5]:(o=T(n.value,2),i=o[0],a=o[1],s=t,c=i,[4,a.getStats(null)]);case 3:s[c]=h.sent(),h.label=4;case 4:return n=r.next(),[3,2];case 5:return[3,8];case 6:return u=h.sent(),f={error:u},[3,8];case 7:try{n&&!n.done&&(l=r.return)&&l.call(r)}finally{if(f)throw f.error}return[7];case 8:return e(t),[2]}}))}))}))},a.sendMessage=function(e,t,r){var n=t.from,o=t.to,i=t.room,s=t.data;return _(a,void 0,void 0,(function(){var t;return A(this,(function(a){switch(a.label){case 0:return[4,new wr({data:s}).setProtectedHeader({alg:"ES256"}).setIssuedAt().setExpirationTime("2h").sign(this.secret)];case 1:return t=a.sent(),this.socket.emit("message",{type:e,from:n,to:o,room:i,token:t},r),[2]}}))}))},a.join=function(){return _(a,void 0,void 0,(function(){var e=this;return A(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){kr("Joining Room"),e.sendMessage("room-join",{room:e.room,data:{name:e.name}},(function(r){var n=r.res,o=r.error;o?(e.emit("error",o),kr("Room Join Error",o)):n&&(kr("Room Joined",n),n.length>1&&(kr("Peers List Recieved"),n.forEach((function(t){t!==e.socket.id&&e.sendMessage("connection-request",{from:e.socket.id,to:t,data:{response:!0,peerName:e.name}})})),Er("Establishing Peer Connection to Remote Peer."),t()))}))}))];case 1:return t.sent(),[2]}}))}))},a.startMedia=function(e){return _(a,void 0,void 0,(function(){var t;return A(this,(function(r){switch(r.label){case 0:return[4,this.getMedia()];case 1:return t=r.sent(),this.addStream(t),e?this.streams=t:(this.streams=t,this.replaceMedia(t)),[2]}}))}))},a.getMedia=function(){return new Promise((function(e,t){navigator.mediaDevices.getUserMedia({video:a.media.video,audio:a.media.audio}).then((function(t){Er(t),e(t)})).catch(t)}))},a.screenShare=function(){return navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(e){var t=e.getVideoTracks()[0];Er("Sharing Screen",t),t.onended=function(e){return _(a,void 0,void 0,(function(){return A(this,(function(t){return Er("Stop Sharing Screen"),this.emit("screen-share-ended",e),this.replaceMedia(this.streams),this.addStream(this.streams),[2]}))}))},a.replaceMedia(e),a.addStream(e)})).catch(console.error)},a.addStream=function(e){var t=document.querySelector(".self");t.srcObject=e,t.onloadedmetadata=function(e){t.play()}},a.toggleMedia=function(e,t){if(e)switch(e){case"video":a.streams.getVideoTracks().forEach((function(e){e.enabled=!e.enabled}));break;case"audio":a.streams.getAudioTracks().forEach((function(e){e.enabled=!e.enabled}));break;case"all":a.streams.getTracks().forEach((function(e){e.enabled=!e.enabled}))}t&&a.peers.get(t).getSenders().forEach((function(t){var r,n;e?(null===(r=null==t?void 0:t.track)||void 0===r?void 0:r.kind)===e&&t.track.stop():null===(n=null==t?void 0:t.track)||void 0===n||n.stop()}))},a.createPoster=function(e){var t=document.createElement("canvas");t.id="canv",t.height=600,t.width=800,document.body.appendChild(t);var r=document.getElementById("canv").getContext("2d");r.fillStyle="#1C1917",r.fillRect(0,0,800,600),r.fillStyle="#FAFAF9",r.textAlign="center",r.font="64px sans-serif",r.fillText(e,400,300);var n=t.toDataURL();return document.body.removeChild(t),n},a.getLocalMedia=function(e){return a.peers.get(e).getLocalStream()},a.getRemoteStream=function(e){return a.peers.get(e).getRemoteStream()},a.replaceMediaTrack=function(e,t){var r,n;if(t)a.peers.get(t).getSenders().forEach((function(t){var r;(null===(r=null==t?void 0:t.track)||void 0===r?void 0:r.kind)===e.kind&&(e.enabled=!0,t.replaceTrack(e))}));else try{for(var o=x(a.peers),i=o.next();!i.done;i=o.next()){var s=T(i.value,2);s[0];s[1].getSenders().forEach((function(t){var r;(null===(r=null==t?void 0:t.track)||void 0===r?void 0:r.kind)===e.kind&&t.replaceTrack(e)}))}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},a.replaceMedia=function(e,t){return new Promise((function(r,n){var o,i,s,c,u,f;try{if(t)try{for(var l=x(e.getTracks()),h=l.next();!h.done;h=l.next()){var p=h.value;t?a.replaceMediaTrack(p,t):a.replaceMediaTrack(p),Er("Replacing Track",p,t)}}catch(e){o={error:e}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}else try{for(var d=x(a.peers),y=d.next();!y.done;y=d.next()){var v=T(y.value,2),m=v[0];if(v[1].getSenders().length>0)try{for(var g=(u=void 0,x(e.getTracks())),b=g.next();!b.done;b=g.next()){p=b.value;a.replaceMediaTrack(p,m),Er("Replacing Track",p,m)}}catch(e){u={error:e}}finally{try{b&&!b.done&&(f=g.return)&&f.call(g)}finally{if(u)throw u.error}}}}catch(e){s={error:e}}finally{try{y&&!y.done&&(c=d.return)&&c.call(d)}finally{if(s)throw s.error}}r(!0)}catch(e){n(e)}}))},a.removePeer=function(e){a.peers.get(e).close(),Cr("Remote Peer Connection Closed"),a.peers.delete(e),Cr("Remote Peer Removed"),a.remoteStreams.delete(e),Cr("Remote Peer Stream Removed")},a.close=function(){var e,t;try{for(var r=x(a.peers),n=r.next();!n.done;n=r.next()){var o=T(n.value,2),i=o[0];o[1];a.removePeer(i)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},a.addMediaTrack=function(e,t){var r,n;if(a.streams.addTrack(e),t)a.peers.get(t).addTrack(e);else if(a.peers.size>0)try{for(var o=x(a.peers),i=o.next();!i.done;i=o.next()){var s=T(i.value,2);s[0];s[1].addTrack(e)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},a.addMedia=function(e,t){e.getTracks().forEach((function(e){return t?a.addMediaTrack(e,t):a.addMediaTrack(e)})),Er("Added new Stream",a.peers)},a.removeMediaTrack=function(e){var t,r,n=function(t,r){r.getSenders().forEach((function(t){var n;(null===(n=null==t?void 0:t.track)||void 0===n?void 0:n.kind)===e.kind&&(r.removeTrack(t),kr("Track Update Request Sent."),a.sendMessage("track-update",{room:a.room,data:{id:r.from.name,update:"end"}}))}))};try{for(var o=x(a.peers),i=o.next();!i.done;i=o.next()){var s=T(i.value,2);s[0];n(0,s[1])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}a.streams.removeTrack(e)},a.removeMedia=function(e){e.getTracks().forEach((function(e){return a.removeMediaTrack(e)})),Er("Removed Stream",e)},a.secret=r,a.hasAudio=i||!0,a.hasVideo=o||!0,a.media={video:a.hasVideo,audio:a.hasAudio},a.streams=new MediaStream,a.startMedia(!0),a.name=btoa(Math.random().toString()).substring(10,5),a.poster=a.createPoster(a.name),a.room=n,a.buffer=50,a.remoteStreams=new Map,a.peers=new Map,a.iceServers=[],a.id=btoa(Math.random().toString()).substring(16,4).split("").map((function(e){return"-_0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[~~(64*Math.random())]})).join(""),a.socket=ze("https://p2p.6buns.com",{transports:["websocket","polling"],auth:{key:a.secret}}),a.socket.on("connection",(function(e,t,r){kr("Socket Connected",{id:e,users:t,iceServers:r}),a.iceServers=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}([],T(r),!1),a.peers.size>0?a.sendMessage("update-socket-id",{room:a.room,data:{id:a.socket.id,name:a.name}}):a.join()})),a.socket.on("message",(function(e){var t=e.type,r=e.from,n=e.to,o=e.room,i=e.token;return a.handleMessage({type:t,from:r,to:n,room:o,token:i})})),a.socket.on("peer-disconnected",(function(e){kr("Socket Disconnected",e),a.removePeer(e)})),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t}(ut.exports.EventEmitter);return Sr}();
